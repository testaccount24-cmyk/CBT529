 CBL DATA(24)
000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. SMFLIST.
000300 AUTHOR. MATTHEW V. STITT.
000400 DATE-WRITTEN. 06/15/91.
000500 DATE-COMPILED.
000600 REMARKS. PRINT LISTING OF PROGRAM EXECUTIONS FROM SMF RECORDS.
000601*****************************************************************
000610*         CHECK THE CURRENT SMF MANUAL FOR EXACT RECORD FORMATS
000611*         AND FIELD DESCRIPTIONS.
000620*****************************************************************
000700 ENVIRONMENT DIVISION.
000800 CONFIGURATION SECTION.
000900 SOURCE-COMPUTER. IBM-3081.
001000 OBJECT-COMPUTER. IBM-3081.
001100 SPECIAL-NAMES.
001200     C01 IS TO-CHAN-1.
001300 INPUT-OUTPUT SECTION.
001400 FILE-CONTROL.
           SELECT PARMIN   ASSIGN TO UT-S-SYS017.
001500     SELECT SMF-DATA ASSIGN TO UT-S-SYS004.
001600     SELECT REPORT-OUT ASSIGN TO UT-S-SYS019.
001700     SELECT SMF-REC-TYPE30 ASSIGN TO UT-S-SORTWK01.
001800 DATA DIVISION.
001900 FILE SECTION.
       FD  PARMIN
           LABEL RECORDS ARE STANDARD
           BLOCK CONTAINS 0 RECORDS.
      *****************************************************************
      *  PARAMETERS TO BE SET UP ARE FOR INCLUSION OR EXCLUSION OF    *
      *  CICS SYSTEMS AND/OR RECORD TYPES FOR REPORTING.              *
      *                                                               *
      *  COL. 1 - I/E  INCLUDE/EXCLUDE ENTRY                          *
      *  COL. 2 - J//T/C/U                                            *
      *           JOB/TYPE/CLASS/USERID                               *
      *  COL. 3 - EMPTY                                               *
      *  COL. 4 - JOB NAME/RECORD TYPE/JOB CLASS/USER ID              *
      *  OPTIONALLY - COL. 1-2 CAN HAVE -NO- FOLLOWED BY:             *
      *           INTERVAL - EXCLUDE TYPE 30 INTERVAL DATA            *
      *           EXCP     - DATA FILE BLOCK COUNTS                   *
      *           ARM      - AUTOMATIC RESTART MANAGER                *
      *           USS      - UNIX SYSTEM SERVICES USAGE               *
      *           USAGE    - USAGE DATA                               *
      *                                                               *
      *****************************************************************
       01  PARM-RECORD.
           03  PARM-TYPE           PIC X(02).
           03  PARM-IO-TYPE        PIC X(01).
           03  PARM-JOB            PIC X(08).
           03  PARM-ARRAY      REDEFINES PARM-JOB
                               OCCURS 8 TIMES.
               04  PARM-CHAR       PIC X(01).
           03  FILLER              PIC X(69).
001910******************************************************************
001911*  IF SORT HAS BEEN USED AGAINST THE SMF DATA THEN THE FOLLOWING *
001911*  FD WILL NEED TO BE MODIFIED TO PROCESS THE FILE AS A VARIABLE *
001912*  INSTEAD OF  A SPANNED RECORD.  SPANNED RECORDS ARE PUT OUT BY *
001913*  IFASMFDP.                                                     *
001920******************************************************************
002000 FD  SMF-DATA
002100     RECORDING MODE IS S
002200     BLOCK CONTAINS 32760 CHARACTERS
002300     RECORD CONTAINS 0 CHARACTERS
002400     LABEL RECORDS ARE STANDARD.
002500 01  SMF-FILE                    PIC X(32756).
002600 FD  REPORT-OUT
002700     LABEL RECORDS ARE OMITTED.
002800 01  PRINT-LINE.
002900     02  P-LINE                  PIC X(133).
003000 SD  SMF-REC-TYPE30.
003100 01  SORT-RECORD.
003200     02  SMF-TIME                PIC S9(8)  COMP.
003300     02  SMF-DATE                PIC 9(7)   COMP-3.
003400     02  SMF-SID                 PIC X(4).
003500     02  SMF-TYPE30.
003510         03  SMF30-PTRS.
003600             04 SMF30WID         PIC X(4).
003700             04 SMF30STP         PIC S9(4)  COMP.
003800             04 SMF30SOF         PIC S9(8)  COMP.
003900             04 SMF30SLN         PIC S9(4)  COMP.
004000             04 SMF30SON         PIC S9(4)  COMP.
004100             04 SMF30IOF         PIC S9(8)  COMP.
004200             04 SMF30ILN         PIC S9(4)  COMP.
004300             04 SMF30ION         PIC S9(4)  COMP.
004400             04 SMF30UOF         PIC S9(8)  COMP.
004500             04 SMF30ULN         PIC S9(4)  COMP.
004600             04 SMF30UON         PIC S9(4)  COMP.
004700             04 SMF30TOF         PIC S9(8)  COMP.
004800             04 SMF30TIF         PIC S9(4)  COMP.
004900             04 SMF30TON         PIC S9(4)  COMP.
005000             04 SMF30COF         PIC S9(8)  COMP.
005100             04 SMF30CLN         PIC S9(4)  COMP.
005200             04 SMF30CON         PIC S9(4)  COMP.
005300             04 SMF30AOF         PIC S9(8)  COMP.
005400             04 SMF30ALN         PIC S9(4)  COMP.
005500             04 SMF30AON         PIC S9(4)  COMP.
005600             04 SMF30ROF         PIC S9(8)  COMP.
005700             04 SMF30RLN         PIC S9(4)  COMP.
005800             04 SMF30RON         PIC S9(4)  COMP.
005900             04 SMF30POF         PIC S9(8)  COMP.
006000             04 SMF30PLN         PIC S9(4)  COMP.
006100             04 SMF30PON         PIC S9(4)  COMP.
006200             04 SMF30OOF         PIC S9(8)  COMP.
006300             04 SMF30OLN         PIC S9(4)  COMP.
006400             04 SMF30OON         PIC S9(4)  COMP.
006500             04 SMF30EOF         PIC S9(8)  COMP.
006600             04 SMF30ELN         PIC S9(4)  COMP.
006700             04 SMF30EON         PIC S9(4)  COMP.
006800             04 SMF30EOR         PIC S9(4)  COMP.
006810             04 SMF30RVD         PIC XX.
006820             04 SMF30EOS         PIC S9(8)  COMP.
006830             04 SMF30DRO         PIC S9(8)  COMP.
006840             04 SMF30DRL         PIC S9(4)  COMP.
006850             04 SMF30DRN         PIC S9(4)  COMP.
006860             04 SMF30ARO         PIC S9(8)  COMP.
006870             04 SMF30ARL         PIC S9(4)  COMP.
006880             04 SMF30ARN         PIC S9(4)  COMP.
006890             04 SMF30OPO         PIC S9(8)  COMP.
006891             04 SMF30OPL         PIC S9(4)  COMP.
006892             04 SMF30OPN         PIC S9(4)  COMP.
006893             04 SMF30UDO         PIC S9(8)  COMP.
006894             04 SMF30UDL         PIC S9(4)  COMP.
006895             04 SMF30UDN         PIC S9(4)  COMP.
006896             04 SMF30UDS         PIC S9(8)  COMP.
006897             04 SMF30RMO         PIC S9(8)  COMP.
006898             04 SMF30RML         PIC S9(4)  COMP.
006899             04 SMF30RMN         PIC S9(4)  COMP.
006900             04 SMF30RMS         PIC S9(8)  COMP.
006897             04 SMF30MOF         PIC S9(8)  COMP.
006898             04 SMF30MLN         PIC S9(4)  COMP.
006899             04 SMF30MNO         PIC S9(4)  COMP.
006900             04 SMF30MOS         PIC S9(8)  COMP.
006910         03  SMF30-SUBSYS.
007000             04  SMF30TYP        PIC S9(4)  COMP.
007100             04  SMF30RS1        PIC XX.
007200             04  SMF30RVN        PIC XX.
007300             04  SMF30PNM        PIC X(8).
007310             04  SMF30OSL        PIC X(8).
007320             04  SMF30SYN        PIC X(8).
007330             04  SMF30SYP        PIC X(8).
007400         03  SMF30-IDENT.
007500             04  SMF30JBN        PIC X(8).
007600             04  SMF30PGM        PIC X(8).
007700             04  SMF30STM        PIC X(8).
007800             04  SMF30UIF        PIC X(8).
007900             04  SMF30JNM        PIC X(8).
008000             04  SMF30STN        PIC S9(4)  COMP.
008100             04  SMF30CLS        PIC X.
008200             04  SMF30RS2        PIC X.
008300             04  SMF30PGN        PIC S9(4)  COMP.
008400             04  SMF30JPT        PIC S9(4)  COMP.
008500             04  SMF30AST        PIC S9(8)  COMP.
008600             04  SMF30PPS        PIC S9(8)  COMP.
008700             04  SMF30SIT        PIC S9(8)  COMP.
008800             04  SMF30STD        PIC 9(7)   COMP-3.
008900             04  SMF30RST        PIC S9(8)  COMP.
009000             04  SMF30RSD        PIC 9(7)   COMP-3.
009100             04  SMF30RET        PIC S9(8)  COMP.
009200             04  SMF30RED        PIC 9(7)   COMP-3.
009300             04  SMF30USR        PIC X(20).
009400             04  SMF30GRP        PIC X(8).
009500             04  SMF30RUD        PIC X(8).
009600             04  SMF30TID        PIC X(8).
009610             04  SMF30TSN        PIC X(8).
009620             04  SMF30PSN        PIC X(8).
009630             04  SMF30CL8        PIC X(8).
009640             04  SMF30ISS        PIC S9(8)  COMP.
009650             04  SMF30IET        PIC S9(8)  COMP.
009660             04  SMF30SSN        PIC S9(8)  COMP.
009670             04  SMF30EXN        PIC X(16).
009700         03  SMF30-IO-ACT.
009800             04  SMF30INP        PIC S9(8)  COMP.
009900             04  SMF30TEP        PIC S9(8)  COMP.
010000             04  SMF30TPT        PIC S9(8)  COMP.
010100             04  SMF30TGT        PIC S9(8)  COMP.
010200             04  SMF30RDR        PIC X.
010300             04  SMF30RDT        PIC X.
010400             04  SMF30TCN        PIC S9(8)  COMP.
010500             04  SMF30MFL        PIC S9(8)  COMP.
010600             04  SMF30RSB        PIC XX.
010700             04  SMF30TRR        PIC S9(8)  COMP.
010710             04  SMF30AIC        PIC S9(8)  COMP.
010720             04  SMF30AID        PIC S9(8)  COMP.
010730             04  SMF30AIW        PIC S9(8)  COMP.
010740             04  SMF30AIS        PIC S9(8)  COMP.
010750             04  SMF30EIC        PIC S9(8)  COMP.
010760             04  SMF30EID        PIC S9(8)  COMP.
010770             04  SMF30EIW        PIC S9(8)  COMP.
010780             04  SMF30EIS        PIC S9(8)  COMP.
010800         03  SMF30-COMPL.
010900             04  SMF30SCC        PIC S9(4)  COMP.
011000             04  SMF30STI        PIC S9(4)  COMP.
011100             04  SMF30ARC        PIC S9(8)  COMP.
011200         03  SMF30-PROC-ACCTG.
011300             04  SMF30PTY        PIC S9(4)  COMP.
011400             04  SMF30TFL        PIC S9(4)  COMP.
011500             04  SMF30CPT        PIC S9(8)  COMP.
011600             04  SMF30CPS        PIC S9(8)  COMP.
011700             04  SMF30ICU        PIC S9(8)  COMP.
011800             04  SMF30ISB        PIC S9(8)  COMP.
011900             04  SMF30JVU        PIC S9(8)  COMP.
012000             04  SMF30IVU        PIC S9(8)  COMP.
012100             04  SMF30JVA        PIC S9(8)  COMP.
012200             04  SMF30IVA        PIC S9(8)  COMP.
012300             04  SMF30IST        PIC S9(8)  COMP.
012400             04  SMF30IDT        PIC S9(8)  COMP.
012410             04  SMF30IIP        PIC S9(8)  COMP.
012420             04  SMF30RCT        PIC S9(8)  COMP.
012430             04  SMF30HPT        PIC S9(8)  COMP.
012440             04  SMF30CSC        PIC S9(8)  COMP.
012450             04  SMF30DMI        PIC S9(8)  COMP.
012460             04  SMF30DMO        PIC S9(8)  COMP.
012470             04  SMF30ASR        PIC S9(8)  COMP.
012480             04  SMF30ENC        PIC S9(8)  COMP.
012490             04  SMF30DET        PIC S9(8)  COMP.
012490             04  SMF30CEP        PIC S9(8)  COMP.
012500         03  SMF30-STG-PAGE.
012600             04  SMF30RSV        PIC XX.
012700             04  SMF30SFL        PIC X.
012800             04  SMF30SPK        PIC X.
012900             04  SMF30PRV        PIC S9(4)  COMP.
013000             04  SMF30SYS        PIC S9(4)  COMP.
013100             04  SMF30PGI        PIC S9(8)  COMP.
013200             04  SMF30PGO        PIC S9(8)  COMP.
013300             04  SMF30CPM        PIC S9(8)  COMP.
013400             04  SMF30NSW        PIC S9(8)  COMP.
013500             04  SMF30PSI        PIC S9(8)  COMP.
013600             04  SMF30PSO        PIC S9(8)  COMP.
013700             04  SMF30VPI        PIC S9(8)  COMP.
013800             04  SMF30VPO        PIC S9(8)  COMP.
013900             04  SMF30VPR        PIC S9(8)  COMP.
014000             04  SMF30CPI        PIC S9(8)  COMP.
014100             04  SMF30HPI        PIC S9(8)  COMP.
014200             04  SMF30LPI        PIC S9(8)  COMP.
014300             04  SMF30HPO        PIC S9(8)  COMP.
014400             04  SMF30PST        PIC S9(8)  COMP.
014500             04  SMF30PSC        PIC S9(16) COMP.
014600             04  SMF30RGB        PIC S9(8)  COMP.
014700             04  SMF30ERG        PIC S9(8)  COMP.
014800             04  SMF30ARB        PIC S9(8)  COMP.
014900             04  SMF30EAR        PIC S9(8)  COMP.
015000             04  SMF30URB        PIC S9(8)  COMP.
015100             04  SMF30EUR        PIC S9(8)  COMP.
015200             04  SMF30RGN        PIC S9(8)  COMP.
015210             04  SMF30DSV        PIC S9(8)  COMP.
015220             04  SMF30PIE        PIC S9(8)  COMP.
015230             04  SMF30POE        PIC S9(8)  COMP.
015240             04  SMF30BIA        PIC S9(8)  COMP.
015250             04  SMF30BOA        PIC S9(8)  COMP.
015260             04  SMF30BIE        PIC S9(8)  COMP.
015270             04  SMF30BOE        PIC S9(8)  COMP.
015280             04  SMF30KIA        PIC S9(8)  COMP.
015290             04  SMF30KOA        PIC S9(8)  COMP.
015291             04  SMF30KIE        PIC S9(8)  COMP.
015292             04  SMF30KOE        PIC S9(8)  COMP.
015293             04  SMF30PSF        PIC S9(16) COMP.
015294             04  SMF30PAI        PIC S9(8)  COMP.
015295             04  SMF30PEI        PIC S9(8)  COMP.
015296             04  SMF30ERS        PIC S9(16) COMP.
015296             04  SMF30MEM        PIC S9(16) COMP.
015296             04  SMF30MLS        PIC X.
015296             04  FILLER          PIC X(23).
015300         03  SMF30-PERF.
015400             04  SMF30SRV        PIC S9(8)  COMP.
015500             04  SMF30CSU        PIC S9(8)  COMP.
015600             04  SMF30SRB        PIC S9(8)  COMP.
015700             04  SMF30IO         PIC S9(8)  COMP.
015800             04  SMF30MSO        PIC S9(8)  COMP.
015900             04  SMF30TAT        PIC S9(8)  COMP.
016000             04  SMF30SUS        PIC S9(8)  COMP.
016100             04  SMF30RES        PIC S9(8)  COMP.
016200             04  SMF30TRS        PIC S9(8)  COMP.
016210             04  SMF30WLM        PIC X(8).
016220             04  SMF30SCN        PIC X(8).
016230             04  SMF30GRN        PIC X(8).
016240             04  SMF30RCN        PIC X(8).
016250             04  SMF30ETA        PIC S9(8)  COMP.
016260             04  SMF30ESU        PIC S9(8)  COMP.
016260             04  SMF30ETC        PIC S9(8)  COMP.
016270             04  SMF30PFL        PIC X(16).
016280             04  SMF30JQT        PIC S9(8)  COMP.
016290             04  SMF30RQT        PIC S9(8)  COMP.
016291             04  SMF30HQT        PIC S9(8)  COMP.
016292             04  SMF30SQT        PIC S9(8)  COMP.
016293             04  SMF30PF1        PIC X.
016293             04  SMF30PF2        PIC X.
016294             04  SMF30RS4        PIC XXX.
016294             04  SMF30JPN        PIC X(8).
016300         03  SMF30-OPER.
016400             04  SMF30PDM        PIC S9(8)  COMP.
016500             04  SMF30PRD        PIC S9(8)  COMP.
016600             04  SMF30PTM        PIC S9(8)  COMP.
016700             04  SMF30TPR        PIC S9(8)  COMP.
016800             04  SMF30MTM        PIC S9(8)  COMP.
016900             04  SMF30MSR        PIC S9(8)  COMP.
017710         03  SMF30-APPC-RES.
017720             04  SMF30DC         PIC S9(8)  COMP.
017730             04  SMF30DCA        PIC S9(8)  COMP.
017740             04  SMF30DSC        PIC S9(4)  COMP.
017750             04  SMF30DDS        PIC X(8).
017760             04  SMF30DRC        PIC S9(8)  COMP.
017770             04  SMF30DDR        PIC X(8).
017780             04  SMF30DAC        PIC S9(8)  COMP.
017790             04  SMF30DTR        PIC S9(8)  COMP.
017791         03  SMF30-APPC-CUM.
017792             04  SMF30CN         PIC S9(8)  COMP.
017793             04  SMF30CNA        PIC S9(8)  COMP.
017794             04  SMF30SEN        PIC S9(4)  COMP.
017795             04  SMF30DAT        PIC X(8).
017796             04  SMF30REC        PIC S9(8)  COMP.
017797             04  SMF30DAR        PIC X(8).
017798             04  SMF30TAC        PIC S9(8)  COMP.
017799             04  SMF30ATR        PIC S9(8)  COMP.
017800         03  SMF30-OMVS.
017801             04  SMF30OPI        PIC S9(8)  COMP.
017802             04  SMF30OPG        PIC S9(8)  COMP.
017803             04  SMF30OUI        PIC S9(8)  COMP.
017804             04  SMF30OUG        PIC S9(8)  COMP.
017805             04  SMF30OSI        PIC S9(8)  COMP.
017806             04  SMF30OSC        PIC S9(8)  COMP.
017807             04  SMF30OST        PIC S9(8)  COMP.
017808             04  SMF30ODR        PIC S9(8)  COMP.
017809             04  SMF30OFR        PIC S9(8)  COMP.
017810             04  SMF30OFW        PIC S9(8)  COMP.
017811             04  SMF30OPR        PIC S9(8)  COMP.
017812             04  SMF30OPW        PIC S9(8)  COMP.
017813             04  SMF30OSR        PIC S9(8)  COMP.
017814             04  SMF30OSW        PIC S9(8)  COMP.
017815             04  SMF30OLL        PIC S9(8)  COMP.
017816             04  SMF30OLP        PIC S9(8)  COMP.
017817             04  SMF30OGL        PIC S9(8)  COMP.
017818             04  SMF30OGP        PIC S9(8)  COMP.
017819             04  SMF30OPP        PIC S9(8)  COMP.
017820             04  SMF30OKR        PIC S9(8)  COMP.
017821             04  SMF30OKW        PIC S9(8)  COMP.
017822             04  SMF30OMS        PIC S9(8)  COMP.
017823             04  SMF30OMR        PIC S9(8)  COMP.
017824             04  SMF30OSY        PIC S9(8)  COMP.
017825         03  SMF30-ARM.
017826             04  SMF30RNM        PIC X(16).
017827             04  SMF30RTP        PIC X(8).
017828             04  SMF30RRG        PIC X(16).
017829             04  SMF30RSN        PIC X(8).
017830             04  SMF30RGT        PIC S9(8)  COMP.
017831             04  SMF30RGD        PIC S9(8)  COMP.
017832             04  SMF30RWT        PIC S9(8)  COMP.
017833             04  SMF30RWD        PIC S9(8)  COMP.
017834             04  SMF30RYT        PIC S9(8)  COMP.
017835             04  SMF30RYD        PIC S9(8)  COMP.
017836             04  SMF30RTT        PIC S9(8)  COMP.
017837             04  SMF30RTD        PIC S9(8)  COMP.
017838         03  SMF30-USAGE.
017839             04  SMF30UPO        PIC X(16).
017840             04  SMF30UPN        PIC X(16).
017841             04  SMF30UPV        PIC X(8).
017842             04  SMF30UPQ        PIC X(8).
017843             04  SMF30UPI        PIC X(8).
017844             04  SMF30UCT        PIC S9(8)  COMP.
017845             04  SMF30UCS        PIC S9(8)  COMP.
017846             04  SMF30URD        PIC X(8).
017847             04  SMF30UDF        PIC X.
017848             04  SMF30UFG        PIC X.
017849             04  SMF30RSV        PIC XX.
017000         03  SMF30-EXCP.
017100             04  SMF30DEV        PIC X.
017200             04  SMF30UTP        PIC X.
017300             04  SMF30CUA        PIC X(2).
017300*            04  SMF30CUA        PIC S9(4)  COMP.
017400             04  SMF30DDN        PIC X(8).
017500             04  SMF30BLK        PIC S9(8)  COMP.
017600             04  SMF30BSZ        PIC S9(4)  COMP.
017700             04  SMF30DCT        PIC S9(8)  COMP.
017700             04  SMF30XBS        PIC S9(16)  COMP.
017860 WORKING-STORAGE SECTION.
017900 77  WS-START                    PIC X(36)  VALUE
018000     'SMFLST30 WORKING STORAGE STARTS HERE'.
018100 77  WORK-CHAR                   PIC X.
018200 77  AB-CODE                     PIC S9(3)  COMP    VALUE ZERO.
018300 77  WORK-BIT-EXPAND             PIC S9(5)  COMP-3  VALUE ZERO.
018400 77  WORK-JUL                    PIC 9(7).
018500 77  WORK-JUL-1                  PIC 9(7).
018600 77  WORK-JUL-2                  PIC 9(7).
018700 77  JUL-DIFF                    PIC S9(7)  COMP-3.
018800 77  G207-FUNC26                 PIC XX     VALUE '26'.
018900 77  G207-FUNC14                 PIC XX     VALUE '14'.
018910 77  G207-FUNC16                 PIC XX     VALUE '16'.
019000 77  PREV-SUBSYS                 PIC X(4).
019100 77  PREV-SUBTYP                 PIC S9(4)  COMP    VALUE ZERO.
019200 77  PREV-TIME                   PIC S9(8)  COMP    VALUE ZERO.
019300 77  PREV-DATE                   PIC 9(7)   COMP-3  VALUE ZERO.
019400 77  LINE-COUNT                  PIC 9(3)           VALUE ZERO.
019500 77  PAGE-CNT                    PIC 9(7)           VALUE ZERO.
019600 77  FIRST-REPORT-SW             PIC 9              VALUE ZERO.
019600 77  WANT-EXCP                   PIC X              VALUE 'Y'.
019600 77  WANT-INTERVAL               PIC X              VALUE 'Y'.
019600 77  WANT-USAGE                  PIC X              VALUE 'Y'.
019600 77  WANT-ARM                    PIC X              VALUE 'Y'.
019600 77  WANT-USS                    PIC X              VALUE 'Y'.
019700 77  W                           PIC 9.
019800 77  X                           PIC S9(15)  COMP.
019900 77  Y                           PIC S9(15)  COMP.
020000 77  Z                           PIC S9(15)  COMP.
020100 77  SMF30-NU-EXCP               PIC S9(8)  COMP.
020110 77  SMF30-NU-OMVS               PIC S9(8)  COMP.
020120 77  SMF30-NU-ARM                PIC S9(8)  COMP.
020120 77  SMF30-NU-USG                PIC S9(8)  COMP.
       77  EJ-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  EJ-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  IJ-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  IJ-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  ET-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  ET-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  IT-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  IT-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  EC-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  EC-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  IC-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  IC-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  EU-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  EU-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  IU-SUB                      PIC 9(03) COMP VALUE ZERO.
       77  IU-SUB2                     PIC 9(03) COMP VALUE ZERO.
       77  PROCESS-ALL                 PIC X(01) VALUE SPACE.
       77  CONT                        PIC X(01) VALUE SPACE.
       77  IO                          PIC X(01) VALUE SPACE.
       77  CHK-MASK                    PIC X(1).
       77  CHK-LN                      PIC 9(02).
020200 01  SMF-RECORD.
020300*    02  REC-LEN                 PIC XX.
020400*    02  SEG-DESC                PIC XX.
020500     02  SYS-IND                 PIC X.
020600     02  REC-TYPE                PIC X.
020700     02  REC-TIME                PIC S9(8)  COMP.
020800     02  REC-DATE                PIC 9(7)   COMP-3.
020900     02  SYS-IDENT               PIC X(4).
021000     02  SMF-DATA-REC.
021100         03  REC-SUBSYS-ID       PIC X(4).
021200         03  REC-SUBTYPE         PIC S9(4)  COMP.
021300         03  SMF-INFO-REC        PIC X(32740).
021400 01  D-TIME.
021500     02  D-HH                    PIC ZZ99.
021600     02  FILLER                  PIC X      VALUE '.'.
021700     02  D-MM                    PIC 99.
021800     02  FILLER                  PIC X      VALUE '.'.
021900     02  D-SS                    PIC 99.
022000 01  TYPE30-DATA.
022100     02  TYPE30-BASIC            PIC X(154).
022200     02  TYPE30-SUBSYS           PIC X(38).
022300     02  TYPE30-IDENT            PIC X(176).
022400     02  TYPE30-IO-ACT           PIC X(64).
022500     02  TYPE30-COMPL            PIC X(8).
022600     02  TYPE30-PROC-ACCTG       PIC X(84).
022700     02  TYPE30-STG-PAGE         PIC X(200).
022800     02  TYPE30-PERF             PIC X(125).
022900     02  TYPE30-OPER             PIC X(24).
023000     02  TYPE30-EXCP             PIC X(30).
023010     02  TYPE30-APPC-RES         PIC X(38).
023020     02  TYPE30-APPC-CUM         PIC X(38).
023030     02  TYPE30-OMVS             PIC X(96).
023040     02  TYPE30-ARM              PIC X(80).
023050     02  TYPE30-USAGE            PIC X(76).
023100 01  HEAD-DESC.
023200     02  FILLER                  PIC X(41) VALUE
023300         'SYSTEM MEASUREMENT FACILITY -- SUBSYSTEM '.
023400     02  HEAD-SUBSYS             PIC X(4).
023500     02  FILLER                  PIC X(17) VALUE
023600         ' -- RECORD TYPE '.
023700     02  HEAD-REC-TYPE           PIC X(20) VALUE SPACE.
023800 01  SUBSYS-REC-TYPES.
023900     02  FILLER                  PIC X(20) VALUE
024000         'START OF JOB'.
024100     02  FILLER                  PIC X(20) VALUE
024200         'INTERVAL USAGE'.
024300     02  FILLER                  PIC X(20) VALUE
024400         'INTERVAL ENDING'.
024500     02  FILLER                  PIC X(20) VALUE
024400         'STEP TERMINATION'.
024700     02  FILLER                  PIC X(20) VALUE
024800         'JOB TERMINATION'.
024900     02  FILLER                  PIC X(20) VALUE
025000         'SYSTEM ADDRESS SPACE'.
025100 01  SUBSYS-DESC-ARRAY           REDEFINES SUBSYS-REC-TYPES.
025200     02  SUBSYS-DESC             OCCURS 6 TIMES
025300                                 PIC X(20).
025400 01  COBALLOC-PARMS.
025500     02  ALLOC-COMMAND           PIC X.
025600     02  ALLOC-DDNAME            PIC X(8).
025700     02  ALLOC-CLASS             PIC X.
025800     02  ALLOC-COPIES            PIC 9(3).
025900     02  ALLOC-DEST              PIC X(5).
026000     02  ALLOC-FREE              PIC X.
026100     02  ALLOC-FORM              PIC X(4).
026200     02  ALLOC-FCB               PIC X(4).
026300     02  ALLOC-RESERVED          PIC X(12).
026400     02  ALLOC-RETURN-CODE       PIC XX.
026500     02  ALLOC-ERROR-CODE        PIC X(4).
026600     02  ALLOC-INFO-CODE         PIC X(4).
026700 01  HEAD-1.
026800     02  FILLER                  PIC X     VALUE SPACE.
026900     02  HEAD-PROGRAM            PIC X(8)  VALUE SPACE.
027000     02  FILLER                  PIC X(47) VALUE SPACE.
027100     02  FILLER                  PIC X(22) VALUE
027200         'ABC DISTRIBUTING      '.
027300     02  FILLER                  PIC X(45) VALUE SPACE.
027400     02  FILLER                  PIC X(5)  VALUE 'PAGE '.
027500     02  HEAD-PAGE               PIC ZZZZ9 VALUE ZERO.
027600 01  HEAD-2.
027700     02  FILLER                  PIC X     VALUE SPACE.
027800     02  FILLER                  PIC X(5)  VALUE 'DATE '.
027900     02  HEAD-DATE               PIC X(10) VALUE SPACE.
028000     02  FILLER                  PIC X(11) VALUE SPACE.
028100     02  HEAD-SYS-DESC           PIC X(80) VALUE SPACE.
028200 01  HEAD-3.
028300     02  FILLER                  PIC X     VALUE SPACE.
028400     02  FILLER                  PIC X(51) VALUE SPACE.
028500     02  HEAD-SEQ                PIC X(30) VALUE SPACE.
028600 01  HEAD-4.
028700     02  FILLER                  PIC X(2)  VALUE SPACE.
028800     02  FILLER                  PIC X(8)  VALUE 'JOB'.
028900     02  FILLER                  PIC X(1)  VALUE SPACE.
029000     02  FILLER                  PIC X(8)  VALUE 'STEP'.
029100     02  FILLER                  PIC X(1)  VALUE SPACE.
029200     02  FILLER                  PIC X(8)  VALUE 'PROGRAM'.
029300     02  FILLER                  PIC X(1)  VALUE SPACE.
029301     02  FILLER                  PIC X(8)  VALUE 'USER'.
029302     02  FILLER                  PIC X(1)  VALUE SPACE.
029303     02  FILLER                  PIC X(3)  VALUE 'JOB'.
029310     02  FILLER                  PIC X(2)  VALUE SPACE.
029400     02  FILLER                  PIC X(10) VALUE 'START'.
029600     02  FILLER                  PIC X(10) VALUE '  START'.
029700     02  FILLER                  PIC X(2)  VALUE SPACE.
029800     02  FILLER                  PIC X(10) VALUE 'END'.
030000     02  FILLER                  PIC X(10) VALUE '  END'.
030200     02  FILLER                  PIC X(10) VALUE ' DURATION '.
030300     02  FILLER                  PIC X(10) VALUE '  CPU'.
030400     02  FILLER                  PIC X(4)  VALUE 'FILE'.
030500     02  FILLER                  PIC X(5)  VALUE SPACE.
030600     02  FILLER                  PIC X(4)  VALUE 'UNIT'.
           02  FILLER                  PIC X(10)  VALUE SPACE.
           02  FILLER                  PIC X(5)  VALUE 'BLOCK'.
030900 01  HEAD-5.
031000     02  FILLER                  PIC X(2)  VALUE SPACE.
031100     02  FILLER                  PIC X(8)  VALUE 'NAME'.
031200     02  FILLER                  PIC X(1)  VALUE SPACE.
031300     02  FILLER                  PIC X(8)  VALUE 'NAME'.
031400     02  FILLER                  PIC X(1)  VALUE SPACE.
031500     02  FILLER                  PIC X(8)  VALUE 'NAME'.
031510     02  FILLER                  PIC X(1)  VALUE SPACE.
031520     02  FILLER                  PIC X(8)  VALUE 'NAME'.
031530     02  FILLER                  PIC X(1)  VALUE SPACE.
031540     02  FILLER                  PIC X(3)  VALUE 'CLS'.
031600     02  FILLER                  PIC X(2)  VALUE SPACE.
031700     02  FILLER                  PIC X(10) VALUE 'DATE'.
031900     02  FILLER                  PIC X(10) VALUE '  TIME'.
032000     02  FILLER                  PIC X(2)  VALUE SPACE.
032010     02  FILLER                  PIC X(10) VALUE 'DATE'.
032020     02  FILLER                  PIC X(10) VALUE '  TIME'.
032500     02  FILLER                  PIC X(10) VALUE '  TIME'.
032510     02  FILLER                  PIC X(10) VALUE '  TIME'.
032700     02  FILLER                  PIC X(8)  VALUE 'NAME'.
032800     02  FILLER                  PIC X(1)  VALUE SPACE.
032900     02  FILLER                  PIC X(4)  VALUE 'ADDR'.
           02  FILLER                  PIC X(10)  VALUE SPACE.
           02  FILLER                  PIC X(5)  VALUE 'COUNT'.
033200 01  DETAIL-LINE.
033300     02  FILLER                  PIC X(2).
033400     02  D-JOB-NAME              PIC X(8).
033500     02  FILLER                  PIC X(1).
033600     02  D-STEP-NAME             PIC X(8).
033700     02  FILLER                  PIC X(1).
033800     02  D-PROG-NAME             PIC X(8).
033810     02  FILLER                  PIC X(1).
033820     02  D-USER-NAME             PIC X(8).
033900     02  FILLER                  PIC X(1).
033901     02  FILLER                  PIC X(1).
033910     02  D-JOB-CLASS             PIC X(1).
033920     02  FILLER                  PIC X(2).
034000     02  D-START-DATE            PIC X(10).
034200     02  D-START-TIME            PIC X(10).
034300     02  FILLER                  PIC X(2).
034400     02  D-END-DATE              PIC X(10).
034600     02  D-END-TIME              PIC X(10).
034800     02  D-DUR-TIME              PIC X(10).
034900     02  D-CPU-TIME              PIC X(10).
034910     02  FILLER                  PIC X(1).
035000     02  D-FILE-NAME             PIC X(8).
035100     02  FILLER                  PIC X(1).
035200     02  D-UNIT-ADDR.
035300         03  D-ADDR-1            PIC X.
035400         03  D-ADDR-2            PIC X.
035500         03  D-ADDR-3            PIC X.
035600         03  D-ADDR-4            PIC X.
035800     02  D-BLK-CNT               PIC Z(15).
035900 01  WORK-BINARY                 PIC 9(8)  COMP.
036000 01  BINARY-WORK             REDEFINES WORK-BINARY
036100                                 PIC XXXX.
036200 01  BINARY-WORK-1           REDEFINES WORK-BINARY.
036300     02  FILLER                  PIC XXX.
036400     02  BINARY-ONE              PIC X.
036500 01  BINARY-WORK-2           REDEFINES WORK-BINARY.
036600     02  FILLER                  PIC XX.
036700     02  BINARY-TWO              PIC XX.
036800 01  BINARY-WORK-3           REDEFINES WORK-BINARY.
036900     02  FILLER                  PIC X.
037000     02  BINARY-THREE            PIC XXX.
037100 01  BINARY-WORK-4           REDEFINES WORK-BINARY.
037200     02  BINARY-FOUR             PIC X(4).
037300 01  EXPAND-BYTE.
037400     02  BIT-ZERO                PIC X.
037500     02  BIT-ONE                 PIC X.
037600     02  BIT-TWO                 PIC X.
037700     02  BIT-THREE               PIC X.
037800     02  BIT-FOUR                PIC X.
037900     02  BIT-FIVE                PIC X.
038000     02  BIT-SIX                 PIC X.
038100     02  BIT-SEVEN               PIC X.
      *------------------------------------------------------------*
      *  EXCLUDE JOB NAME TABLE                                    *
      *------------------------------------------------------------*
       01  EJ-TABLE.
           05  EJ-ENTRY OCCURS 100 TIMES.
               10  EJ-MASK               PIC X(1).
               10  EJ-IO                 PIC X(1).
               10  EJ-LN                 PIC 9(02).
               10  EJ-JOB                PIC X(08).
      *------------------------------------------------------------*
      *  INCLUDE JOB NAME TABLE                                    *
      *------------------------------------------------------------*
       01  IJ-TABLE.
           05  IJ-ENTRY OCCURS 100 TIMES.
               10  IJ-MASK               PIC X(1).
               10  IJ-IO                 PIC X(1).
               10  IJ-LN                 PIC 9(02).
               10  IJ-JOB                PIC X(08).
      *------------------------------------------------------------*
      *  EXCLUDE WORK NAME TABLE                                   *
      *------------------------------------------------------------*
       01  ET-TABLE.
           05  ET-ENTRY OCCURS 100 TIMES.
               10  ET-MASK               PIC X(1).
               10  ET-IO                 PIC X(1).
               10  ET-LN                 PIC 9(02).
               10  ET-WID                PIC X(04).
      *------------------------------------------------------------*
      *  INCLUDE WORK NAME TABLE                                   *
      *------------------------------------------------------------*
       01  IT-TABLE.
           05  IT-ENTRY OCCURS 100 TIMES.
               10  IT-MASK               PIC X(1).
               10  IT-IO                 PIC X(1).
               10  IT-LN                 PIC 9(02).
               10  IT-WID                PIC X(04).
      *------------------------------------------------------------*
      *  EXCLUDE JOB CLASS TABLE                                   *
      *------------------------------------------------------------*
       01  EC-TABLE.
           05  EC-ENTRY OCCURS 100 TIMES.
               10  EC-MASK               PIC X(1).
               10  EC-IO                 PIC X(1).
               10  EC-LN                 PIC 9(02).
               10  EC-CLS                PIC X(01).
      *------------------------------------------------------------*
      *  INCLUDE JOB CLASS TABLE                                   *
      *------------------------------------------------------------*
       01  IC-TABLE.
           05  IC-ENTRY OCCURS 100 TIMES.
               10  IC-MASK               PIC X(1).
               10  IC-IO                 PIC X(1).
               10  IC-LN                 PIC 9(02).
               10  IC-CLS                PIC X(01).
      *------------------------------------------------------------*
      *  EXCLUDE USER ID TABLE                                     *
      *------------------------------------------------------------*
       01  EU-TABLE.
           05  EU-ENTRY OCCURS 100 TIMES.
               10  EU-MASK               PIC X(1).
               10  EU-IO                 PIC X(1).
               10  EU-LN                 PIC 9(02).
               10  EU-USER               PIC X(08).
      *------------------------------------------------------------*
      *  INCLUDE USER ID TABLE                                     *
      *------------------------------------------------------------*
       01  IU-TABLE.
           05  IU-ENTRY OCCURS 100 TIMES.
               10  IU-MASK               PIC X(1).
               10  IU-IO                 PIC X(1).
               10  IU-LN                 PIC 9(02).
               10  IU-USER               PIC X(08).
      *------------------------------------------------------------*
      *  DSN OR JOB REDEFINES AREAS                                *
      *------------------------------------------------------------*
       01  WORK-VALUE.
           05  WK-CHAR               OCCURS 8 TIMES
                                     PIC X(1).
       01  CHK-FLD.
           05  CHK-CHAR              OCCURS 8 TIMES
                                     PIC X(1).
038200 01  WORK-ARRAY-ONE.
038300     02  ARRAY-ONE           OCCURS 32760 TIMES  INDEXED BY A1.
038400         03  CHAR-ONE            PIC X.
038500 01  WORK-ARRAY-TWO.
038600     02  ARRAY-TWO           OCCURS 32760 TIMES  INDEXED BY A2.
038700         03  CHAR-TWO            PIC X.
038800 PROCEDURE DIVISION.
           OPEN INPUT  PARMIN.
           MOVE LOW-VALUES TO EJ-TABLE.
           MOVE LOW-VALUES TO IJ-TABLE.
           MOVE LOW-VALUES TO ET-TABLE.
           MOVE LOW-VALUES TO IT-TABLE.
           MOVE LOW-VALUES TO EC-TABLE.
           MOVE LOW-VALUES TO IC-TABLE.
           MOVE LOW-VALUES TO EU-TABLE.
           MOVE LOW-VALUES TO IU-TABLE.
       PROCESS-PARMS.
      *************************************************************
      *  READ A PARAMETER CARD (IF THERE ARE ANY).                *
      *************************************************************
           READ PARMIN AT END
               GO TO CHK-PARM-COUNT.
           IF PARM-TYPE = 'NO'
               GO TO CHECK-OPTIONS.
           IF PARM-TYPE = 'EJ'
               GO TO LOAD-EJ.
           IF PARM-TYPE = 'IJ'
               GO TO LOAD-IJ.
           IF PARM-TYPE = 'ET'
               GO TO LOAD-ET.
           IF PARM-TYPE = 'IT'
               GO TO LOAD-IT.
           IF PARM-TYPE = 'EC'
               GO TO LOAD-EC.
           IF PARM-TYPE = 'IC'
               GO TO LOAD-IC.
           IF PARM-TYPE = 'EU'
               GO TO LOAD-EU.
           IF PARM-TYPE = 'IU'
               GO TO LOAD-IU.
           GO TO CHECK-PARM-NV.
      *-----------------------------------------------------------*
       LOAD-EJ.
      *************************************************************
      *  LOAD A EXCLUDE JOB RECORD                                *
      *************************************************************
           ADD 1 TO EJ-SUB.
           IF EJ-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE EJ PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO EJ-JOB (EJ-SUB).
       FIND-EJ-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-EJ-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-EJ-MASK-LOOP.
           MOVE 'Y' TO EJ-MASK (EJ-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO EJ-LN (EJ-SUB).
           DISPLAY 'JOB MASK : ' EJ-JOB (EJ-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-EJ-MASK-LOOP.
           DISPLAY 'JOB      : ' EJ-JOB (EJ-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       LOAD-IJ.
      *************************************************************
      *  LOAD A INCLUDE JOB RECORD                                *
      *************************************************************
           ADD 1 TO IJ-SUB.
           IF IJ-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE IJ PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO IJ-JOB (IJ-SUB).
       FIND-IJ-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-IJ-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-IJ-MASK-LOOP.
           MOVE 'Y' TO IJ-MASK (IJ-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO IJ-LN (IJ-SUB).
           DISPLAY 'JOB MASK : ' IJ-JOB (IJ-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-IJ-MASK-LOOP.
           DISPLAY 'JOB      : ' IJ-JOB (IJ-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
      *-----------------------------------------------------------*
       LOAD-ET.
      *************************************************************
      *  LOAD A EXCLUDE WORK NAME TYPE RECORD                     *
      *************************************************************
           ADD 1 TO ET-SUB.
           IF ET-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE ET PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO ET-WID (ET-SUB).
       FIND-ET-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-ET-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-ET-MASK-LOOP.
           MOVE 'Y' TO ET-MASK (ET-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO ET-LN (ET-SUB).
           DISPLAY 'WORK NAME : ' ET-WID (ET-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-ET-MASK-LOOP.
           DISPLAY 'WORK NAME : ' ET-WID (ET-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       LOAD-IT.
      *************************************************************
      *  LOAD A INCLUDE WORK NAME RECORD                          *
      *************************************************************
           ADD 1 TO IT-SUB.
           IF IT-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE IT PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO IT-WID (IT-SUB).
       FIND-IT-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-IT-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-IT-MASK-LOOP.
           MOVE 'Y' TO IT-MASK (IT-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO IT-LN (IT-SUB).
           DISPLAY 'WORK MASK: ' IT-WID (IT-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-IT-MASK-LOOP.
           DISPLAY 'WORK MASK: ' IT-WID (IT-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
      *-----------------------------------------------------------*
       LOAD-EC.
      *************************************************************
      *  LOAD A EXCLUDE JOB CLASS TYPE RECORD                     *
      *************************************************************
           ADD 1 TO EC-SUB.
           IF EC-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE EC PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO EC-CLS (EC-SUB).
       FIND-EC-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-EC-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-EC-MASK-LOOP.
           MOVE 'Y' TO EC-MASK (EC-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO EC-LN (EC-SUB).
           DISPLAY 'WORK NAME : ' EC-CLS (EC-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-EC-MASK-LOOP.
           DISPLAY 'WORK NAME : ' EC-CLS (EC-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       LOAD-IC.
      *************************************************************
      *  LOAD A INCLUDE JOB CLASS RECORD                          *
      *************************************************************
           ADD 1 TO IC-SUB.
           IF IC-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE IC PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO IC-CLS (IC-SUB).
       FIND-IC-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-IC-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-IC-MASK-LOOP.
           MOVE 'Y' TO IC-MASK (IC-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO IC-LN (IC-SUB).
           DISPLAY 'WORK MASK: ' IC-CLS (IC-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-IC-MASK-LOOP.
           DISPLAY 'WORK MASK: ' IC-CLS (IC-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
      *-----------------------------------------------------------*
       LOAD-EU.
      *************************************************************
      *  LOAD A EXCLUDE USER RECORD                               *
      *************************************************************
           ADD 1 TO EU-SUB.
           IF EU-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE EU PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO EU-USER (EU-SUB).
       FIND-EU-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-EU-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-EU-MASK-LOOP.
           MOVE 'Y' TO EU-MASK (EU-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO EU-LN (EU-SUB).
           DISPLAY 'USER MASK : ' EU-USER (EU-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-EU-MASK-LOOP.
           DISPLAY 'USER      : ' EU-USER (EU-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       LOAD-IU.
      *************************************************************
      *  LOAD A INCLUDE USER RECORD                               *
      *************************************************************
           ADD 1 TO IU-SUB.
           IF IU-SUB > 100
               DISPLAY 'MORE THAN 100 TYPE IU PARAMETER CARDS'
               DISPLAY 'PARAMETER CARD NOT PROCESSED         '
               DISPLAY PARM-RECORD
               MOVE 999 TO AB-CODE
               CALL 'ILBOABN0' USING AB-CODE.
           MOVE ZERO TO X.
           MOVE PARM-JOB TO IU-USER (IU-SUB).
       FIND-IU-MASK-LOOP.
           ADD 1 TO X.
           IF X > 8
               GO TO END-IU-MASK-LOOP.
           IF PARM-CHAR (X) NOT = '*'
               GO TO FIND-IU-MASK-LOOP.
           MOVE 'Y' TO IU-MASK (IU-SUB).
           SUBTRACT 1 FROM X.
           MOVE X TO IU-LN (IU-SUB).
           DISPLAY 'USER MASK : ' IU-USER (IU-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
       END-IU-MASK-LOOP.
           DISPLAY 'USER      : ' IU-USER (IU-SUB) ' TO BE SELECTED'.
           MOVE 'N' TO PROCESS-ALL.
           GO TO PROCESS-PARMS.
      *-----------------------------------------------------------*
       CHECK-OPTIONS.
           IF PARM-JOB = 'XCP'
               MOVE 'N' TO WANT-EXCP
               DISPLAY 'CARD PROCESSED: ' PARM-RECORD
               GO TO PROCESS-PARMS.
           IF PARM-JOB = 'NTERVAL'
               MOVE 'N' TO WANT-INTERVAL
               DISPLAY 'CARD PROCESSED: ' PARM-RECORD
               GO TO PROCESS-PARMS.
           IF PARM-JOB = 'RM'
               MOVE 'N' TO WANT-ARM
               DISPLAY 'CARD PROCESSED: ' PARM-RECORD
               GO TO PROCESS-PARMS.
           IF PARM-JOB = 'SAGE'
               MOVE 'N' TO WANT-USAGE
               DISPLAY 'CARD PROCESSED: ' PARM-RECORD
               GO TO PROCESS-PARMS.
           IF PARM-JOB = 'SS'
               MOVE 'N' TO WANT-USS
               DISPLAY 'CARD PROCESSED: ' PARM-RECORD
               GO TO PROCESS-PARMS.
       CHECK-PARM-NV.
           DISPLAY 'INVALID PARAMETER TYPE, MUST BE EJ, IJ, ET, IT'.
           DISPLAY '                                EC, IC'.
           DISPLAY 'CARD PROCESSED: ' PARM-RECORD.
           MOVE 888 TO AB-CODE.
           CALL 'ILBOABN0' USING AB-CODE.
       CHK-PARM-COUNT.
           CLOSE PARMIN.
           IF RETURN-CODE > 0
             GOBACK.
038900     SORT SMF-REC-TYPE30 ASCENDING SMF30WID,
039000                                   SMF30STP,
039100                                   SMF-DATE,
039200                                   SMF-TIME
039300         INPUT PROCEDURE IS SELECT-RECORDS
039400         OUTPUT PROCEDURE IS PRINT-REPORT.
039500 FINISH-JOB.
039600     GOBACK.
039700*****************************************************************
039800*  THIS ROUTINE WILL FORMAT A BINARY BYTE (EIGHT BITS) INTO     *
039900*  EIGHT BYTES WITH THE BIT ON AND OFF REPRESENTATION IN EACH   *
040000*  BYTE.  THE BINARY BYTE IS PUT INTO FIELD WORK-CHAR AND THE   *
040100*  EIGHT BYTES ARE RETURNED IN FIELD EXPAND-BYTE.  THE FOUR     *
040200*  BYTE FIELDS WORK-BINARY ARE USED HEAVILY IN THIS ROUTINE     *
040300*****************************************************************
040400 EXPAND-BITS.
040500     MOVE LOW-VALUES TO BINARY-WORK.
040600     MOVE WORK-CHAR TO BINARY-ONE.
040700     COMPUTE WORK-BIT-EXPAND = WORK-BINARY.
040800     MOVE ALL ZERO TO EXPAND-BYTE.
040900     SUBTRACT 128 FROM WORK-BIT-EXPAND.
041000     IF WORK-BIT-EXPAND LESS THAN ZERO
041100         MOVE '0' TO BIT-ZERO
041200         ADD 128 TO WORK-BIT-EXPAND
041300       ELSE MOVE '1' TO BIT-ZERO.
041400     SUBTRACT 064 FROM WORK-BIT-EXPAND.
041500     IF WORK-BIT-EXPAND LESS THAN ZERO
041600         MOVE '0' TO BIT-ONE
041700         ADD 064 TO WORK-BIT-EXPAND
041800       ELSE MOVE '1' TO BIT-ONE.
041900     SUBTRACT 032 FROM WORK-BIT-EXPAND.
042000     IF WORK-BIT-EXPAND LESS THAN ZERO
042100         MOVE '0' TO BIT-TWO
042200         ADD 032 TO WORK-BIT-EXPAND
042300       ELSE MOVE '1' TO BIT-TWO.
042400     SUBTRACT 016 FROM WORK-BIT-EXPAND.
042500     IF WORK-BIT-EXPAND LESS THAN ZERO
042600         MOVE '0' TO BIT-THREE
042700         ADD 016 TO WORK-BIT-EXPAND
042800       ELSE MOVE '1' TO BIT-THREE.
042900     SUBTRACT 008 FROM WORK-BIT-EXPAND.
043000     IF WORK-BIT-EXPAND LESS THAN ZERO
043100         MOVE '0' TO BIT-FOUR
043200         ADD 008 TO WORK-BIT-EXPAND
043300       ELSE MOVE '1' TO BIT-FOUR.
043400     SUBTRACT 004 FROM WORK-BIT-EXPAND.
043500     IF WORK-BIT-EXPAND LESS THAN ZERO
043600         MOVE '0' TO BIT-FIVE
043700         ADD 004 TO WORK-BIT-EXPAND
043800       ELSE MOVE '1' TO BIT-FIVE.
043900     SUBTRACT 002 FROM WORK-BIT-EXPAND.
044000     IF WORK-BIT-EXPAND LESS THAN ZERO
044100         MOVE '0' TO BIT-SIX
044200         ADD 002 TO WORK-BIT-EXPAND
044300       ELSE MOVE '1' TO BIT-SIX.
044400     SUBTRACT 001 FROM WORK-BIT-EXPAND.
044500     IF WORK-BIT-EXPAND LESS THAN ZERO
044600         MOVE '0' TO BIT-SEVEN
044700         ADD 001 TO WORK-BIT-EXPAND
044800       ELSE MOVE '1' TO BIT-SEVEN.
044900 TRANSFER-DATA.
045000     MOVE ZERO TO X.
045100     SET A2 TO X.
045200     MOVE LOW-VALUES TO WORK-ARRAY-TWO.
045300 TRANSFER-LOOP.
045400     SET A2 UP BY 1.
045500     IF A2 > Y
045600         GO TO END-TRANSFER-LOOP.
045700     SET A1 UP BY 1.
045800     MOVE CHAR-ONE (A1) TO CHAR-TWO (A2).
045900     GO TO TRANSFER-LOOP.
046000 END-TRANSFER-LOOP.
046100     EXIT.
046200 NEW-REPORT-SETUP.
046300     IF FIRST-REPORT-SW NOT = ZERO
046400         CLOSE REPORT-OUT.
046500     MOVE 1 TO FIRST-REPORT-SW.
046600     MOVE SPACE TO COBALLOC-PARMS.
046700     MOVE 'A' TO ALLOC-COMMAND.
046800     MOVE 'SYS019' TO ALLOC-DDNAME.
046900     MOVE 'X' TO ALLOC-CLASS.
047000     MOVE 'Y' TO ALLOC-FREE.
047100     CALL 'COBALLOC' USING COBALLOC-PARMS.
047200     IF ALLOC-RETURN-CODE NOT = '00'
047300         DISPLAY  'ERROR ' ALLOC-RETURN-CODE
047400                  ' RETURN CODE ' ALLOC-ERROR-CODE
047500                  ' REASON CODE ' ALLOC-INFO-CODE
047600                  ' FROM COBALLOC'
047700         MOVE +999 TO AB-CODE
047800         CALL 'ILBOABN0' USING AB-CODE.
047900     OPEN OUTPUT REPORT-OUT.
      *************************************************************
       CHECK-FIELD.
      *************************************************************
      *  CHK FOR EXCLUDE OR INCLUDE                               *
      *************************************************************
           MOVE 'Y' TO CONT.
           IF CHK-MASK NOT = 'Y'
               AND CHK-FLD NOT = WORK-VALUE
               MOVE 'N' TO CONT
               GO TO CHK-FLD-EXIT.
           MOVE ZERO TO X.
       CHK-CHAR-LOOP.
           ADD 1 TO X.
           IF X > CHK-LN
               GO TO CHK-FLD-EXIT.
           IF X > 8
               GO TO CHK-FLD-EXIT.
           IF WK-CHAR (X) NOT = CHK-CHAR (X)
               MOVE 'N' TO CONT
               GO TO CHK-FLD-EXIT.
           GO TO CHK-CHAR-LOOP.
       CHK-FLD-EXIT.
           EXIT.
048000 SELECT-RECORDS SECTION.
048100     OPEN INPUT SMF-DATA.
048200 READ-FILE.
048300     MOVE LOW-VALUES TO SMF-RECORD.
048400     READ SMF-DATA INTO SMF-RECORD AT END
048500         GO TO END-SELECT.
048600     MOVE REC-TYPE TO WORK-CHAR.
048700     MOVE LOW-VALUES TO BINARY-WORK.
048800     MOVE WORK-CHAR TO BINARY-ONE.
048900     COMPUTE WORK-BIT-EXPAND = WORK-BINARY.
049000     IF WORK-BIT-EXPAND NOT = 30
049100         GO TO READ-FILE.
 49200     MOVE LOW-VALUES TO SORT-RECORD.
049200     MOVE SMF-DATA-REC TO SMF30-PTRS, TYPE30-BASIC.
           IF (SMF30STP = 2
                 OR SMF30STP = 3)
065910         AND WANT-INTERVAL NOT = 'Y'
               GO TO READ-FILE.
049400     MOVE REC-DATE TO SMF-DATE.
049500     MOVE REC-TIME TO SMF-TIME.
049500     MOVE SYS-IDENT TO SMF-SID.
049600     MOVE LOW-VALUES TO WORK-ARRAY-ONE.
049700     MOVE SMF-RECORD TO WORK-ARRAY-ONE.
049710 REC30-SUBSYSTEMS.
049720     IF SMF30SON < 1
049730         GO TO REC30-IDENTIFICATION.
049800     SET A1 TO SMF30SOF.
049900     SET A1 DOWN BY 4.
050000     MOVE SMF30SLN TO Y.
050100     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
050200     MOVE WORK-ARRAY-TWO TO TYPE30-SUBSYS.
050300     MOVE TYPE30-SUBSYS TO SMF30-SUBSYS.
050310     IF SMF30SON > 1
050320         DISPLAY 'SUBSYSTEMS OVERFLOW'.
050330 REC30-IDENTIFICATION.
050340     IF SMF30ION < 1
050350         GO TO REC30-I-O-ACT.
050400*    IF SMF30TYP NOT = 4
050500*        GO TO READ-FILE.
050600     SET A1 TO SMF30IOF.
050700     SET A1 DOWN BY 4.
050800     MOVE SMF30ILN TO Y.
050900     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
051000     MOVE WORK-ARRAY-TWO TO TYPE30-IDENT.
051100     MOVE TYPE30-IDENT TO SMF30-IDENT.
051110     IF SMF30ION > 1
051120         DISPLAY 'IDENTIFICATION OVERFLOW'.
051130 REC30-I-O-ACT.
      *************************************************************
      *  CHECK PROCESS-ALL                                        *
      *************************************************************
           IF PROCESS-ALL NOT = 'N'
             GO TO FORMAT-DATA.
           MOVE ZERO TO EJ-SUB2.
           MOVE ZERO TO IJ-SUB2.
           MOVE ZERO TO ET-SUB2.
           MOVE ZERO TO IT-SUB2.
           MOVE ZERO TO EC-SUB2.
           MOVE ZERO TO IC-SUB2.
           MOVE ZERO TO EU-SUB2.
           MOVE ZERO TO IU-SUB2.
      *************************************************************
      *  CHECK TO SEE JOB IS TO BE INCLUDED                       *
      *************************************************************
       CHK-EJ.
           ADD 1 TO EJ-SUB2.
           IF EJ-SUB2 > EJ-SUB
             GO TO CHK-IJ.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30JBN TO WORK-VALUE.
           MOVE EJ-JOB (EJ-SUB2) TO CHK-FLD.
           MOVE EJ-LN (EJ-SUB2) TO CHK-LN.
           MOVE EJ-MASK (EJ-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-EJ.
      *************************************************************
      *  CHECK TO SEE JOB IS TO BE INCLUDED                       *
      *************************************************************
       CHK-IJ.
           ADD 1 TO IJ-SUB2.
           IF IJ-SUB2 > IJ-SUB
             GO TO CHK-ET.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30JBN TO WORK-VALUE.
           MOVE IJ-JOB (IJ-SUB2) TO CHK-FLD.
           MOVE IJ-LN (IJ-SUB2) TO CHK-LN.
           MOVE IJ-MASK (IJ-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-IJ.
      *************************************************************
      *  CHECK TO SEE WORK TYPE IS TO BE EXCLUDED                 *
      *************************************************************
       CHK-ET.
           ADD 1 TO ET-SUB2.
           IF ET-SUB2 > ET-SUB
             GO TO CHK-IT.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30WID TO WORK-VALUE.
           MOVE ET-WID (ET-SUB2) TO CHK-FLD.
           MOVE ET-LN (ET-SUB2) TO CHK-LN.
           MOVE ET-MASK (ET-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-ET.
      *************************************************************
      *  CHECK TO SEE WORK TYPE IS TO BE INCLUDED                 *
      *************************************************************
       CHK-IT.
           ADD 1 TO IT-SUB2.
           IF IT-SUB2 > IT-SUB
             GO TO CHK-EC.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30WID TO WORK-VALUE.
           MOVE IT-WID (IT-SUB2) TO CHK-FLD.
           MOVE IT-LN (IT-SUB2) TO CHK-LN.
           MOVE IT-MASK (IT-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-IT.
      *************************************************************
      *  CHECK TO SEE JOB CLASS IS TO BE EXCLUDED                 *
      *************************************************************
       CHK-EC.
           ADD 1 TO EC-SUB2.
           IF EC-SUB2 > EC-SUB
             GO TO CHK-IC.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30CLS TO WORK-VALUE.
           MOVE EC-CLS (EC-SUB2) TO CHK-FLD.
           MOVE EC-LN (EC-SUB2) TO CHK-LN.
           MOVE EC-MASK (EC-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-EC.
      *************************************************************
      *  CHECK TO SEE JOB CLASS IS TO BE INCLUDED                 *
      *************************************************************
       CHK-IC.
           ADD 1 TO IC-SUB2.
           IF IC-SUB2 > IC-SUB
             GO TO CHK-EU.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30CLS TO WORK-VALUE.
           MOVE IC-CLS (IC-SUB2) TO CHK-FLD.
           MOVE IC-LN (IC-SUB2) TO CHK-LN.
           MOVE IC-MASK (IC-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-IT.
      *************************************************************
      *  CHECK TO SEE USER IS TO BE INCLUDED                      *
      *************************************************************
       CHK-EU.
           ADD 1 TO EU-SUB2.
           IF EU-SUB2 > EU-SUB
             GO TO CHK-IU.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30RUD TO WORK-VALUE.
           MOVE EU-USER (EU-SUB2) TO CHK-FLD.
           MOVE EU-LN (EU-SUB2) TO CHK-LN.
           MOVE EU-MASK (EU-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-EU.
      *************************************************************
      *  CHECK TO SEE USER IS TO BE INCLUDED                      *
      *************************************************************
       CHK-IU.
           ADD 1 TO IU-SUB2.
           IF IU-SUB2 > IU-SUB
             GO TO READ-FILE.
           MOVE 'N' TO CONT.
           MOVE SPACES TO WORK-VALUE.
           MOVE SMF30RUD TO WORK-VALUE.
           MOVE IU-USER (IU-SUB2) TO CHK-FLD.
           MOVE IU-LN (IU-SUB2) TO CHK-LN.
           MOVE IU-MASK (IU-SUB2) TO CHK-MASK.
           PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
           IF CONT = 'Y'
             GO TO FORMAT-DATA.
           GO TO CHK-IU.
       FORMAT-DATA.
051140     IF SMF30UON < 1
051150         GO TO REC30-COMPLETES.
051200     SET A1 TO SMF30UOF.
051300     SET A1 DOWN BY 4.
051400     MOVE SMF30ULN TO Y.
051500     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
051600     MOVE WORK-ARRAY-TWO TO TYPE30-IO-ACT.
051700     MOVE TYPE30-IO-ACT TO SMF30-IO-ACT.
051710     IF SMF30UON > 1
051720         DISPLAY 'I/O ACTIVITY OVERFLOW'.
051730 REC30-COMPLETES.
051740     IF SMF30TON < 1
051750         GO TO REC30-PROCESSOR.
051800     SET A1 TO SMF30TOF.
051900     SET A1 DOWN BY 4.
052000     MOVE SMF30TIF TO Y.
052100     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
052200     MOVE WORK-ARRAY-TWO TO TYPE30-COMPL.
052300     MOVE TYPE30-COMPL TO SMF30-COMPL.
052310     IF SMF30TON > 1
052320         DISPLAY 'COMPLETIONS OVERFLOW'.
052330 REC30-PROCESSOR.
052340     IF SMF30CON < 1
052350         GO TO REC30-PAGING.
052400     SET A1 TO SMF30COF.
052500     SET A1 DOWN BY 4.
052600     MOVE SMF30CLN TO Y.
052700     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
052800     MOVE WORK-ARRAY-TWO TO TYPE30-PROC-ACCTG.
052900     MOVE TYPE30-PROC-ACCTG TO SMF30-PROC-ACCTG.
052910     IF SMF30CON > 1
052920         DISPLAY 'PROCESSOR OVERFLOW'.
052930 REC30-PAGING.
052940     IF SMF30RON < 1
052950         GO TO REC30-PERFORMANCE.
053000     SET A1 TO SMF30ROF.
053100     SET A1 DOWN BY 4.
053200     MOVE SMF30RLN TO Y.
053300     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
053400     MOVE WORK-ARRAY-TWO TO TYPE30-STG-PAGE.
053500     MOVE TYPE30-STG-PAGE TO SMF30-STG-PAGE.
053510     IF SMF30RON > 1
053520         DISPLAY 'PAGING OVERFLOW'.
053530 REC30-PERFORMANCE.
053540     IF SMF30PON < 1
053550         GO TO REC30-OPERATOR.
053600     SET A1 TO SMF30POF.
053700     SET A1 DOWN BY 4.
053800     MOVE SMF30PLN TO Y.
053900     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054000     MOVE WORK-ARRAY-TWO TO TYPE30-PERF.
054100     MOVE TYPE30-PERF TO SMF30-PERF.
054110     IF SMF30PON > 1
054120         DISPLAY 'PERFORMANCE OVERFLOW'.
054130 REC30-OPERATOR.
054140     IF SMF30OON < 1
054150         GO TO REC30-APPC-RES.
054200     SET A1 TO SMF30OOF.
054300     SET A1 DOWN BY 4.
054400     MOVE SMF30OLN TO Y.
054500     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054600     MOVE WORK-ARRAY-TWO TO TYPE30-OPER.
054700     MOVE TYPE30-OPER TO SMF30-OPER.
054701     IF SMF30OON > 1
054702         DISPLAY 'OPERATOR OVERFLOW'.
054703 REC30-APPC-RES.
054704     IF SMF30DRN < 1
054705         GO TO REC30-APPC-CUM.
054706     SET A1 TO SMF30DRO.
054707     SET A1 DOWN BY 4.
054708     MOVE SMF30DRL TO Y.
054709     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054710     MOVE WORK-ARRAY-TWO TO TYPE30-APPC-RES.
054711     MOVE TYPE30-APPC-RES TO SMF30-APPC-RES.
054712     IF SMF30DRN > 1
054713         DISPLAY 'APPC RESOURCE OVERFLOW'.
054714 REC30-APPC-CUM.
054715     IF SMF30ARN < 1
054716         GO TO REC30-OMVS.
054717     SET A1 TO SMF30ARO.
054718     SET A1 DOWN BY 4.
054719     MOVE SMF30ARL TO Y.
054720     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054721     MOVE WORK-ARRAY-TWO TO TYPE30-APPC-CUM.
054722     MOVE TYPE30-APPC-CUM TO SMF30-APPC-CUM.
054723     IF SMF30ARN > 1
054724         DISPLAY 'APPC CUMULATIVE OVERFLOW'.
054725 REC30-OMVS.
054814     IF WANT-USS NOT = 'Y'
054816         GO TO REC30-USAGE.
           IF SMF30STP = 5
054752         RELEASE SORT-RECORD
054816         GO TO READ-FILE.
054726     IF SMF30OPN < 1
054727         GO TO REC30-USAGE.
054728     SET A1 TO SMF30OPO.
054729     SET A1 DOWN BY 4.
054730     MOVE SMF30OPL TO Y.
054734     IF SMF30OPN > 1
054735         DISPLAY 'OMVS OVERFLOW'.
054745     MOVE SMF30OPN TO SMF30-NU-OMVS.
054746 OMVS-LOOP.
054736     MOVE LOW-VALUES TO SMF30-OMVS.
054747     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054748     MOVE WORK-ARRAY-TWO TO TYPE30-OMVS.
054749     MOVE REC-DATE TO SMF-DATE.
054750     MOVE REC-TIME TO SMF-TIME.
049500     MOVE SYS-IDENT TO SMF-SID.
054751     MOVE TYPE30-OMVS TO SMF30-OMVS.
054752     RELEASE SORT-RECORD.
 49200     MOVE LOW-VALUES TO SORT-RECORD.
054756     MOVE TYPE30-BASIC TO SMF-TYPE30.
054757     MOVE TYPE30-SUBSYS TO SMF30-SUBSYS.
054758     MOVE TYPE30-IDENT TO SMF30-IDENT.
054759     MOVE TYPE30-IO-ACT TO SMF30-IO-ACT.
054760     MOVE TYPE30-COMPL TO SMF30-COMPL.
054761     MOVE TYPE30-PROC-ACCTG TO SMF30-PROC-ACCTG.
054762     MOVE TYPE30-STG-PAGE TO SMF30-STG-PAGE.
054763     MOVE TYPE30-PERF TO SMF30-PERF.
054764     MOVE TYPE30-OPER TO SMF30-OPER.
054765     SUBTRACT 1 FROM SMF30-NU-OMVS.
054766     IF SMF30-NU-OMVS > 0
054767         GO TO OMVS-LOOP.
054768 REC30-USAGE.
054814     IF WANT-USAGE NOT = 'Y'
054816         GO TO REC30-ARM.
054769     IF SMF30UDN < 1
054770         GO TO REC30-ARM.
054771     SET A1 TO SMF30UDO.
054772     SET A1 DOWN BY 4.
054773     MOVE SMF30UDL TO Y.
054777     IF SMF30UDN > 1
054778         DISPLAY 'USAGE OVERFLOW'.
054790     MOVE SMF30UDN TO SMF30-NU-USG.
054791 USAGE-LOOP.
054774     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054775     MOVE WORK-ARRAY-TWO TO TYPE30-USAGE.
054794     MOVE REC-DATE TO SMF-DATE.
054795     MOVE REC-TIME TO SMF-TIME.
049500     MOVE SYS-IDENT TO SMF-SID.
054751     MOVE TYPE30-USAGE TO SMF30-USAGE.
054797     RELEASE SORT-RECORD.
 49200     MOVE LOW-VALUES TO SORT-RECORD.
054798     MOVE TYPE30-BASIC TO SMF-TYPE30.
054799     MOVE TYPE30-SUBSYS TO SMF30-SUBSYS.
054800     MOVE TYPE30-IDENT TO SMF30-IDENT.
054801     MOVE TYPE30-IO-ACT TO SMF30-IO-ACT.
054802     MOVE TYPE30-COMPL TO SMF30-COMPL.
054803     MOVE TYPE30-PROC-ACCTG TO SMF30-PROC-ACCTG.
054804     MOVE TYPE30-STG-PAGE TO SMF30-STG-PAGE.
054805     MOVE TYPE30-PERF TO SMF30-PERF.
054806     MOVE TYPE30-OPER TO SMF30-OPER.
054807     SUBTRACT 1 FROM SMF30-NU-USG.
054808     IF SMF30-NU-USG > 0
054809         GO TO USAGE-LOOP.
054779 REC30-ARM.
054814     IF WANT-ARM NOT = 'Y'
054816         GO TO REC30-EXCP.
054780     IF SMF30RMN < 1
054781         GO TO REC30-EXCP.
054782     SET A1 TO SMF30RMO.
054783     SET A1 DOWN BY 4.
054784     MOVE SMF30RML TO Y.
054788     IF SMF30RMN > 1
054789         DISPLAY 'ARM OVERFLOW'.
054790     MOVE SMF30RMN TO SMF30-NU-ARM.
054791 ARM-LOOP.
054792     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
054793     MOVE WORK-ARRAY-TWO TO TYPE30-ARM.
054794     MOVE REC-DATE TO SMF-DATE.
054795     MOVE REC-TIME TO SMF-TIME.
049500     MOVE SYS-IDENT TO SMF-SID.
054796     MOVE TYPE30-ARM TO SMF30-ARM.
054797     RELEASE SORT-RECORD.
 49200     MOVE LOW-VALUES TO SORT-RECORD.
054798     MOVE TYPE30-BASIC TO SMF-TYPE30.
054799     MOVE TYPE30-SUBSYS TO SMF30-SUBSYS.
054800     MOVE TYPE30-IDENT TO SMF30-IDENT.
054801     MOVE TYPE30-IO-ACT TO SMF30-IO-ACT.
054802     MOVE TYPE30-COMPL TO SMF30-COMPL.
054803     MOVE TYPE30-PROC-ACCTG TO SMF30-PROC-ACCTG.
054804     MOVE TYPE30-STG-PAGE TO SMF30-STG-PAGE.
054805     MOVE TYPE30-PERF TO SMF30-PERF.
054806     MOVE TYPE30-OPER TO SMF30-OPER.
054807     SUBTRACT 1 FROM SMF30-NU-ARM.
054808     IF SMF30-NU-ARM > 0
054809         GO TO ARM-LOOP.
054811 REC30-EXCP.
054814     IF WANT-EXCP NOT = 'Y'
054815         RELEASE SORT-RECORD
054816         GO TO READ-FILE.
054820     SET A1 TO SMF30EOF.
054900     SET A1 DOWN BY 4.
055000     MOVE SMF30ELN TO Y.
055100     MOVE SMF30EON TO SMF30-NU-EXCP.
055110     IF SMF30EON > 1
055120         DISPLAY 'EXCP OVERFLOW'.
055200 EXCP-LOOP.
055300     PERFORM TRANSFER-DATA THROUGH END-TRANSFER-LOOP.
055400     MOVE WORK-ARRAY-TWO TO TYPE30-EXCP.
055500     MOVE REC-DATE TO SMF-DATE.
055600     MOVE REC-TIME TO SMF-TIME.
049500     MOVE SYS-IDENT TO SMF-SID.
055700     MOVE TYPE30-EXCP TO SMF30-EXCP.
055800     RELEASE SORT-RECORD.
 49200     MOVE LOW-VALUES TO SORT-RECORD.
056200     MOVE TYPE30-BASIC TO SMF-TYPE30.
056300     MOVE TYPE30-SUBSYS TO SMF30-SUBSYS.
056400     MOVE TYPE30-IDENT TO SMF30-IDENT.
056500     MOVE TYPE30-IO-ACT TO SMF30-IO-ACT.
056600     MOVE TYPE30-COMPL TO SMF30-COMPL.
056700     MOVE TYPE30-PROC-ACCTG TO SMF30-PROC-ACCTG.
056800     MOVE TYPE30-STG-PAGE TO SMF30-STG-PAGE.
056900     MOVE TYPE30-PERF TO SMF30-PERF.
057000     MOVE TYPE30-OPER TO SMF30-OPER.
057010     SUBTRACT 1 FROM SMF30-NU-EXCP.
057020     IF SMF30-NU-EXCP > 0
057100         GO TO EXCP-LOOP.
057110     GO TO READ-FILE.
057200 END-SELECT.
057300     CLOSE SMF-DATA.
057400 END-SELECT-EXIT.
057500     EXIT.
057600 PRINT-REPORT SECTION.
057700     MOVE LOW-VALUE TO PREV-SUBSYS.
057800     MOVE ZERO TO PREV-SUBTYP.
057900     MOVE 'SMFLST30' TO HEAD-PROGRAM.
058000     MOVE 'SYSTEM MEASUREMENT FACILITY -- PROGRAMS RUN'
058100         TO HEAD-SYS-DESC.
058200     MOVE 'AS GIVEN ON DATA FILE' TO HEAD-SEQ.
058300     CALL 'G207DCAN' USING G207-FUNC14, HEAD-DATE.
058400     GO TO GET-SMF-DATA.
058500 PRINT-HEADINGS-ROUTINE.
058600     ADD 1 TO PAGE-CNT
058700     MOVE PAGE-CNT TO HEAD-PAGE.
058800     MOVE HEAD-1 TO PRINT-LINE.
058900     WRITE PRINT-LINE AFTER ADVANCING TO-CHAN-1.
059000     MOVE HEAD-2 TO PRINT-LINE.
059100     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
059200     MOVE HEAD-3 TO PRINT-LINE.
059300     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
059400     MOVE HEAD-4 TO PRINT-LINE.
059500     WRITE PRINT-LINE AFTER ADVANCING 2 LINES.
059600     MOVE HEAD-5 TO PRINT-LINE.
059700     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
059800     MOVE SPACE TO PRINT-LINE.
059900     MOVE ZERO TO LINE-COUNT.
060000 PRINT-1.
060100     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
060200     ADD 1 TO LINE-COUNT.
060300     IF LINE-COUNT > 52
060400         PERFORM PRINT-HEADINGS-ROUTINE.
060500 PRINT-EXIT.
060600     EXIT.
060700 GET-SMF-DATA.
060800     RETURN SMF-REC-TYPE30 AT END
060900         GO TO FINISH-REPORT.
           IF (SMF30STP = 2
                 OR SMF30STP = 3
                 OR SMF30STP = 4)
065910         AND (SMF30CUA = SPACE
065910           OR SMF30CUA = LOW-VALUES)
065910         AND WANT-EXCP = 'Y'
               GO TO GET-SMF-DATA.
061000     IF SMF30WID NOT = PREV-SUBSYS
061100         MOVE SMF30WID TO PREV-SUBSYS
061200         MOVE SMF30STP TO PREV-SUBTYP
061300         MOVE ZERO TO PAGE-CNT
061400         MOVE SMF30WID TO HEAD-SUBSYS
061500         MOVE SUBSYS-DESC (SMF30STP) TO HEAD-REC-TYPE
061600         MOVE HEAD-DESC TO HEAD-SYS-DESC
061700         PERFORM NEW-REPORT-SETUP
061800         PERFORM PRINT-HEADINGS-ROUTINE THROUGH PRINT-EXIT.
061900     IF SMF30STP NOT = PREV-SUBTYP
062000         MOVE SMF30STP TO PREV-SUBTYP
062100         MOVE ZERO TO PAGE-CNT
062200         MOVE SUBSYS-DESC (SMF30STP) TO HEAD-REC-TYPE
062300         MOVE HEAD-DESC TO HEAD-SYS-DESC
062400         PERFORM NEW-REPORT-SETUP
062500         PERFORM PRINT-HEADINGS-ROUTINE THROUGH PRINT-EXIT.
062600     MOVE SPACE TO DETAIL-LINE.
062700     MOVE SMF30JBN TO D-JOB-NAME.
062800     MOVE SMF30STM TO D-STEP-NAME.
062900     MOVE SMF30PGM TO D-PROG-NAME.
062910     MOVE SMF30RUD TO D-USER-NAME.
062920     MOVE SMF30CLS TO D-JOB-CLASS.
062700     IF D-JOB-NAME = LOW-VALUES
               MOVE SPACE TO D-JOB-NAME.
062800     IF D-STEP-NAME = LOW-VALUES
               MOVE SPACE TO D-STEP-NAME.
062900     IF D-PROG-NAME = LOW-VALUES
               MOVE SPACE TO D-PROG-NAME.
062910     IF D-USER-NAME = LOW-VALUES
               MOVE SPACE TO D-USER-NAME.
062920     IF D-JOB-CLASS = LOW-VALUES
               MOVE SPACE TO D-JOB-CLASS.
063000     DIVIDE SMF-TIME BY 100 GIVING X.
063100     DIVIDE X BY 3600 GIVING D-HH
063200         REMAINDER Y.
063300     DIVIDE Y BY 60 GIVING D-MM
063400         REMAINDER D-SS.
063500     MOVE D-TIME TO D-END-TIME.
063600     MOVE SMF-DATE TO WORK-JUL.
           IF WORK-JUL < 1900000
               ADD 1900000 TO WORK-JUL.
063700     MOVE WORK-JUL TO WORK-JUL-1.
063800     CALL 'G207DCAN' USING G207-FUNC16, WORK-JUL D-END-DATE.
064410     IF SMF30STP = 1
               MOVE D-END-TIME TO D-START-TIME
               MOVE D-END-DATE TO D-START-DATE
               MOVE SPACE TO D-END-TIME
               MOVE SPACE TO D-END-DATE
064420         GO TO PRINT-DATA.
063900     DIVIDE SMF30SIT BY 100 GIVING X.
064000     DIVIDE X BY 3600 GIVING D-HH
064100         REMAINDER Y.
064200     DIVIDE Y BY 60 GIVING D-MM
064300         REMAINDER D-SS.
064400     MOVE D-TIME TO D-START-TIME.
064500     MOVE SMF30STD TO WORK-JUL.
           IF WORK-JUL < 1900000
               ADD 1900000 TO WORK-JUL.
064600     MOVE WORK-JUL TO WORK-JUL-2.
064700     CALL 'G207DCAN' USING G207-FUNC16, WORK-JUL D-START-DATE.
064800     MOVE ZERO TO JUL-DIFF.
064910     CALL 'G207DCAN' USING JUL-DIFF, WORK-JUL-2, WORK-JUL-1.
065000     COMPUTE X = (8640000 * JUL-DIFF) + SMF-TIME + 1.
065110     SUBTRACT SMF30SIT FROM X GIVING Z.
065200     DIVIDE Z BY 100 GIVING X.
065300     DIVIDE X BY 3600 GIVING D-HH
065400         REMAINDER Y.
065500     DIVIDE Y BY 60 GIVING D-MM
065600         REMAINDER D-SS.
065700     MOVE D-TIME TO D-DUR-TIME.
065710     ADD SMF30CPT, SMF30CPS  GIVING Z.
065720     DIVIDE Z BY 100 GIVING X.
065730     DIVIDE X BY 3600 GIVING D-HH
065740         REMAINDER Y.
065750     DIVIDE Y BY 60 GIVING D-MM
065760         REMAINDER D-SS.
065770     MOVE D-TIME TO D-CPU-TIME.
065800     IF SMF30-EXCP = LOW-VALUES
065900         GO TO PRINT-DATA.
065910     IF SMF30DDN = SPACE
065920         OR SMF30DDN = LOW-VALUES
065930         GO TO PRINT-DATA.
066000     MOVE SMF30DDN TO D-FILE-NAME.
066100     MOVE LOW-VALUES TO WORK-ARRAY-ONE.
066200     MOVE SMF30CUA TO WORK-ARRAY-ONE.
066300     MOVE CHAR-ONE (1) TO WORK-CHAR.
066400     PERFORM EXPAND-BITS.
066500     MOVE ZERO TO X.
066600     IF BIT-ZERO = '1'
066700         ADD 8 TO X.
066800     IF BIT-ONE = '1'
066900         ADD 4 TO X.
067000     IF BIT-TWO = '1'
067100         ADD 2 TO X.
067200     IF BIT-THREE = '1'
067300         ADD 1 TO X.
067400     IF X < 10
067500         MOVE X TO W
067600         MOVE W TO D-ADDR-1.
067700     IF X = 10
067800         MOVE 'A' TO D-ADDR-1.
067900     IF X = 11
068000         MOVE 'B' TO D-ADDR-1.
068100     IF X = 12
068200         MOVE 'C' TO D-ADDR-1.
068300     IF X = 13
068400         MOVE 'D' TO D-ADDR-1.
068500     IF X = 14
068600         MOVE 'E' TO D-ADDR-1.
068700     IF X = 15
068800         MOVE 'F' TO D-ADDR-1.
068900     MOVE ZERO TO X.
069000     IF BIT-FOUR = '1'
069100         ADD 8 TO X.
069200     IF BIT-FIVE = '1'
069300         ADD 4 TO X.
069400     IF BIT-SIX = '1'
069500         ADD 2 TO X.
069600     IF BIT-SEVEN = '1'
069700         ADD 1 TO X.
069800     IF X < 10
069900         MOVE X TO W
070000         MOVE W TO D-ADDR-2.
070100     IF X = 10
070200         MOVE 'A' TO D-ADDR-2.
070300     IF X = 11
070400         MOVE 'B' TO D-ADDR-2.
070500     IF X = 12
070600         MOVE 'C' TO D-ADDR-2.
070700     IF X = 13
070800         MOVE 'D' TO D-ADDR-2.
070900     IF X = 14
071000         MOVE 'E' TO D-ADDR-2.
071100     IF X = 15
071200         MOVE 'F' TO D-ADDR-2.
071300     MOVE CHAR-ONE (2) TO WORK-CHAR.
071400     PERFORM EXPAND-BITS.
071500     MOVE ZERO TO X.
071600     IF BIT-ZERO = '1'
071700         ADD 8 TO X.
071800     IF BIT-ONE = '1'
071900         ADD 4 TO X.
072000     IF BIT-TWO = '1'
072100         ADD 2 TO X.
072200     IF BIT-THREE = '1'
072300         ADD 1 TO X.
072400     IF X < 10
072500         MOVE X TO W
072600         MOVE W TO D-ADDR-3.
072700     IF X = 10
072800         MOVE 'A' TO D-ADDR-3.
072900     IF X = 11
073000         MOVE 'B' TO D-ADDR-3.
073100     IF X = 12
073200         MOVE 'C' TO D-ADDR-3.
073300     IF X = 13
073400         MOVE 'D' TO D-ADDR-3.
073500     IF X = 14
073600         MOVE 'E' TO D-ADDR-3.
073700     IF X = 15
073800         MOVE 'F' TO D-ADDR-3.
073900     MOVE ZERO TO X.
074000     IF BIT-FOUR = '1'
074100         ADD 8 TO X.
074200     IF BIT-FIVE = '1'
074300         ADD 4 TO X.
074400     IF BIT-SIX = '1'
074500         ADD 2 TO X.
074600     IF BIT-SEVEN = '1'
074700         ADD 1 TO X.
074800     IF X < 10
074900         MOVE X TO W
075000         MOVE W TO D-ADDR-4.
075100     IF X = 10
075200         MOVE 'A' TO D-ADDR-4.
075300     IF X = 11
075400         MOVE 'B' TO D-ADDR-4.
075500     IF X = 12
075600         MOVE 'C' TO D-ADDR-4.
075700     IF X = 13
075800         MOVE 'D' TO D-ADDR-4.
075900     IF X = 14
076000         MOVE 'E' TO D-ADDR-4.
076100     IF X = 15
076200         MOVE 'F' TO D-ADDR-4.
076300     MOVE SMF30BLK TO D-BLK-CNT.
076400 PRINT-DATA.
076500     MOVE DETAIL-LINE TO P-LINE.
076600     PERFORM PRINT-1 THROUGH PRINT-EXIT.
076700     GO TO GET-SMF-DATA.
076800 FINISH-REPORT.
076900     CLOSE REPORT-OUT.
077000 PRINT-REPORT-EXIT.
077100     EXIT.
