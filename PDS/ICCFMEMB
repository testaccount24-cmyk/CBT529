000100 ID DIVISION.
000200 PROGRAM-ID. ICCFMEMB.
000300 AUTHOR. MATTHEW STITT.
000400 DATE-WRITTEN. 03/09/04.
000500 DATE-COMPILED.
000600 REMARKS.  GET MEMBER FROM ICCF BACKUP TAPE.
000700 ENVIRONMENT DIVISION.
000800 CONFIGURATION SECTION.
000900 SOURCE-COMPUTER.  IBM-2066.
001000 OBJECT-COMPUTER.  IBM-2066.
001100 SPECIAL-NAMES.
001200     C01 IS TO-CHAN-1.
001300 INPUT-OUTPUT SECTION.
001400 FILE-CONTROL.
001500     SELECT PARMIN   ASSIGN TO UT-S-SYSIN.
001600     SELECT MEMBER-OUT ASSIGN TO UT-S-ICCFMEM.
001700     SELECT LIST-OUT ASSIGN TO UT-S-SYS007.
001900     SELECT ICCF-INP ASSIGN TO UT-S-ICCFBKP.
002000 DATA DIVISION.
002100 FILE SECTION.
002200 FD  PARMIN
002300     RECORDING MODE IS F
002400     LABEL RECORDS ARE STANDARD
002500     BLOCK CONTAINS 0 RECORDS.
002510*****************************************************************
002520*  PARAMETERS TO BE SET UP ARE FOR INCLUSION OR EXCLUSION OF    *
002530*  CICS SYSTEMS AND/OR RECORD TYPES FOR REPORTING.              *
002540*                                                               *
002550*  COL. 1 - I/E  INCLUDE/EXCLUDE ENTRY                          *
002560*  COL. 2 - L/M  LIBRARY/MEMBER TO UNLOAD                       *
002561*  COL. 3 - EMPTY                                               *
002562*  COL. 4 - LIBRARY NUMBER/MEMBER NAME                          *
002570*                                                               *
002590*****************************************************************
002600 01  PARM-RECORD.
002700     03  PARM-TYPE           PIC X(02).
002800     03  FILLER              PIC X(01).
002900     03  PARM-NAME           PIC X(77).
003000     03  PARM-ARRAY        REDEFINES PARM-NAME.
003100         05  PARM-CHAR   OCCURS 77 TIMES
003200                             PIC X.
003300 FD  ICCF-INP
003400     LABEL RECORDS ARE STANDARD
003500     BLOCK CONTAINS 0 RECORDS
003700     RECORDING MODE IS F.
003800 01  ICCF-BKP-IN.
003900     02  BKP-HEADER          PIC X(2).
004000     02  BKP-LIB-INFO.
004100         03  BKP-LIB-NO      PIC 9(4)  COMP.
004200         03  FILLER          PIC X(6).
004300     02  BKP-MEMB-INFO       REDEFINES BKP-LIB-INFO.
004400         03  BKP-MEM-NAME    PIC X(8).
004410     02  FILLER              PIC X(70).
004420     02  BKP-REC-TYPE        PIC X.
004500 FD  LIST-OUT
004600     RECORDING MODE IS F
004700     LABEL RECORDS ARE OMITTED.
004800 01  PRINT-LINE              PIC X(133).
005300 FD  MEMBER-OUT
005400     LABEL RECORDS ARE STANDARD
005410     BLOCK CONTAINS 0 RECORDS
005420     RECORDING MODE IS F.
005500 01  CARD-OUT                PIC X(80).
006300 WORKING-STORAGE SECTION.
006400 77  WS-START                PIC X(36) VALUE
006500     'ICCFMEMB WORKING STORAGE STARTS HERE'.
006600 77  NBR-RECORDS-READ        PIC 9(18) VALUE ZERO.
006700 77  NBR-RECORDS-USED        PIC 9(18) VALUE ZERO.
007000 77  AB-CODE                 PIC S9(3) COMP    VALUE ZERO.
007100 77  PAGE-CNT                PIC 9(07) COMP-3 VALUE ZERO.
007300 77  LINE-COUNT              PIC 9(03) COMP-3 VALUE ZERO.
008100 77  G207-FUNC14             PIC XX     VALUE '14'.
008110 77  G207-FUNC16             PIC XX     VALUE '16'.
008200 77  G207-FUNC17             PIC XX     VALUE '17'.
008300 77  G207-FUNC20             PIC XX     VALUE '20'.
008400 77  G207-FUNC22             PIC XX     VALUE '22'.
008500 77  G207-FUNC34             PIC XX     VALUE '34'.
008800 77  X                       PIC 9(08) COMP VALUE ZERO.
008810 77  EL-LIB-PARM             PIC X(04).
008811 77  EL-LIB-NO               REDEFINES EL-LIB-PARM PIC 9(04).
008820 77  IL-LIB-PARM             PIC X(04).
008830 77  IL-LIB-NO               REDEFINES IL-LIB-PARM PIC 9(04).
008900 77  EL-SUB                  PIC 9(03) COMP VALUE ZERO.
009000 77  IL-SUB                  PIC 9(03) COMP VALUE ZERO.
009100 77  EL-SUB2                 PIC 9(03) COMP VALUE ZERO.
009200 77  IL-SUB2                 PIC 9(03) COMP VALUE ZERO.
009300 77  EM-SUB                  PIC 9(03) COMP VALUE ZERO.
009400 77  IM-SUB                  PIC 9(03) COMP VALUE ZERO.
009500 77  EM-SUB2                 PIC 9(03) COMP VALUE ZERO.
009600 77  IM-SUB2                 PIC 9(03) COMP VALUE ZERO.
010300 77  LIB-WANTED              PIC X(01) VALUE SPACE.
010301 77  MEM-WANTED              PIC X(01) VALUE SPACE.
010310 77  PROCESS-ALL             PIC X(01) VALUE SPACE.
010400 77  CONT                    PIC X(01) VALUE SPACE.
010500 77  IO                      PIC X(01) VALUE SPACE.
010700 77  CHK-MASK                PIC X(1).
010800 77  CHK-LN                  PIC 9(02).
020800*------------------------------------------------------------*
020900*  EXCLUDE LIBRARY NUMBER TABLE                              *
021000*------------------------------------------------------------*
021100 01  EL-TABLE.
021200     05  EL-ENTRY        OCCURS 100 TIMES.
021300         10  EL-MASK         PIC X(1)  VALUE LOW-VALUES.
021400         10  EL-IO           PIC X(1)  VALUE LOW-VALUES.
021500         10  EL-LN           PIC 9(2)  VALUE ZERO.
021600         10  EL-LIB          PIC 9(04) COMP VALUE ZERO.
021610*------------------------------------------------------------*
021620*  INCLUDE LIBRARY NUMBER TABLE                              *
021630*------------------------------------------------------------*
021640 01  IL-TABLE.
021650     05  IL-ENTRY        OCCURS 100 TIMES.
021660         10  IL-MASK         PIC X(1)  VALUE LOW-VALUES.
021670         10  IL-IO           PIC X(1)  VALUE LOW-VALUES.
021680         10  IL-LN           PIC 9(2)  VALUE ZERO.
021690         10  IL-LIB          PIC 9(04) COMP VALUE ZERO.
022600*------------------------------------------------------------*
022700*  EXCLUDE MEMBER NAME TABLE                                 *
022800*------------------------------------------------------------*
022900 01  EM-TABLE.
023000     05  EM-ENTRY        OCCURS 36 TIMES.
023010         10  EM-MASK         PIC X(1)  VALUE LOW-VALUES.
023020         10  EM-IO           PIC X(1)  VALUE LOW-VALUES.
023030         10  EM-LN           PIC 9(2)  VALUE ZERO.
023040         10  EM-MEMB         PIC X(08) VALUE LOW-VALUES.
023050*------------------------------------------------------------*
023060*  INCLUDE MEMBER NAME TABLE                                 *
023070*------------------------------------------------------------*
023080 01  IM-TABLE.
023090     05  IM-ENTRY        OCCURS 36 TIMES.
023100         10  IM-MASK         PIC X(1)  VALUE LOW-VALUES.
023200         10  IM-IO           PIC X(1)  VALUE LOW-VALUES.
023300         10  IM-LN           PIC 9(2)  VALUE ZERO.
023400         10  IM-MEMB         PIC X(08) VALUE LOW-VALUES.
024650*------------------------------------------------------------*
024700*  JOB REDEFINES AREAS                                       *
024800*------------------------------------------------------------*
024900 01  WORK-VALUE.
025000     05  WK-CHAR         OCCURS 77 TIMES
025100                             PIC X(1).
025200 01  CHK-FLD.
025300     05  CHK-CHAR        OCCURS 77 TIMES
025400                             PIC X(1).
025500 01  WORK-DATE.
025600     02  WORK-MM             PIC 99.
025700     02  FILLER              PIC X.
025800     02  WORK-DD             PIC 99.
025900     02  FILLER              PIC X.
026000     02  WORK-YY             PIC 9999.
026010 01  WORK-MONTH.
026020     02  WORK-MON            PIC 99.
026030     02  FILLER              PIC X     VALUE '/'.
026060     02  WORK-YEAR           PIC 9999.
027000 01  HEAD-1.
027100     02  FILLER              PIC X     VALUE SPACE.
027200     02  HEAD-PROGRAM        PIC X(8)  VALUE SPACE.
027300     02  FILLER              PIC X(47) VALUE SPACE.
027400     02  FILLER              PIC X(22) VALUE
027500         'ABC DISTRIBUTING LLC'.
027600     02  FILLER              PIC X(44) VALUE SPACE.
027700     02  FILLER              PIC X(5)  VALUE 'PAGE '.
027800     02  HEAD-PAGE           PIC ZZZZ9 VALUE ZERO.
027900 01  HEAD-2.
028000     02  FILLER              PIC X     VALUE SPACE.
028100     02  FILLER              PIC X(5)  VALUE 'DATE '.
028200     02  HEADER-DATE         PIC X(10) VALUE SPACE.
028300     02  FILLER              PIC X(11) VALUE SPACE.
028400     02  HEAD-SYS-DESC       PIC X(80) VALUE SPACE.
028500 01  HEAD-3.
028600     02  FILLER              PIC X     VALUE SPACE.
028700     02  FILLER              PIC X(51) VALUE SPACE.
028800     02  HEAD-SEQ            PIC X(30) VALUE SPACE.
028900 01  HEAD-4.
029000     02  FILLER              PIC X(2)  VALUE SPACE.
029100     02  HEAD-R-4-A          PIC X(8).
029110     02  FILLER              PIC X(2)  VALUE SPACE.
029120     02  HEAD-R-4-B          PIC X(8).
029200 01  HEAD-5.
029300     02  FILLER              PIC X(2)  VALUE SPACE.
029400     02  HEAD-R-5-A          PIC X(8).
029500     02  FILLER              PIC X(2)  VALUE SPACE.
029600     02  HEAD-R-5-B          PIC X(8).
029800 01  DETAIL-LINE.
029900     02  FILLER              PIC X(2).
030000     02  D-LIBRY-ID          PIC 9(4).
030100     02  FILLER              PIC X(6).
030200     02  D-ENTRY-ID          PIC X(8).
033100 01  CTL-CARD.
033101     02  CTL-PARM            PIC X(12) VALUE
033102         './ ADD NAME='.
033104     02  CTL-NAME            PIC X(8).
033110 PROCEDURE DIVISION.
033200     OPEN INPUT  PARMIN.
033500 PROCESS-PARMS.
033600*************************************************************
033700*  READ A PARAMETER CARD (IF THERE ARE ANY).                *
033800*************************************************************
033900     READ PARMIN AT END
034000         GO TO CHK-PARM-COUNT.
034100     ADD 1 TO NBR-RECORDS-READ.
034594     IF PARM-TYPE = 'EL'
034595         GO TO LOAD-EL.
034596     IF PARM-TYPE = 'IL'
034597         GO TO LOAD-IL.
034598     IF PARM-TYPE = 'EM'
034599         GO TO LOAD-EM.
034600     IF PARM-TYPE = 'IM'
034601         GO TO LOAD-IM.
034610     GO TO CHECK-PARM-NV.
034700*-----------------------------------------------------------*
046746*************************************************************
046747*  LOAD A EXCLUDE LU NAME RECORD                            *
046748*************************************************************
046749 LOAD-EL.
046750     ADD 1 TO EL-SUB.
046751     IF EL-SUB > 100
046752         DISPLAY 'MORE THAN 100 TYPE EL PARAMETER CARDS'
046753         DISPLAY 'PARAMETER CARD NOT PROCESSED         '
046754         DISPLAY PARM-RECORD
046755         MOVE 999 TO AB-CODE
046756         CALL 'ILBOABN0' USING AB-CODE.
046757     MOVE ZERO TO X.
046758     MOVE PARM-NAME TO EL-LIB-PARM.
046759     MOVE EL-LIB-NO TO EL-LIB (EL-SUB).
046761 FIND-EL-MASK-LOOP.
046762     ADD 1 TO X.
046763     IF X > 8
046764         GO TO END-EL-MASK-LOOP.
046765     IF PARM-CHAR (X) NOT = '*'
046766         GO TO FIND-EL-MASK-LOOP.
046767     MOVE 'Y' TO EL-MASK (EL-SUB).
046768     SUBTRACT 1 FROM X.
046769     MOVE X TO EL-LN (EL-SUB).
046770     DISPLAY 'LIBRARY MASK : '
046771             EL-LIB-NO ' TO BE EXCLUDED'.
046772     GO TO PROCESS-PARMS.
046773 END-EL-MASK-LOOP.
046774     DISPLAY 'LIBRARY     : '
046775             EL-LIB-NO ' TO BE EXCLUDED'.
046776     GO TO PROCESS-PARMS.
046777*************************************************************
046778*  LOAD A INCLUDE LU NAME RECORD                            *
046779*************************************************************
046780 LOAD-IL.
046781     ADD 1 TO IL-SUB.
046782     IF IL-SUB > 100
046783         DISPLAY 'MORE THAN 100 TYPE IL PARAMETER CARDS'
046784         DISPLAY 'PARAMETER CARD NOT PROCESSED         '
046785         DISPLAY PARM-RECORD
046786         MOVE 999 TO AB-CODE
046787         CALL 'ILBOABN0' USING AB-CODE.
046788     MOVE ZERO TO X.
046789     MOVE PARM-NAME TO IL-LIB-PARM.
046790     MOVE IL-LIB-NO TO IL-LIB (IL-SUB).
046791 FIND-IL-MASK-LOOP.
046792     ADD 1 TO X.
046793     IF X > 8
046794         GO TO END-IL-MASK-LOOP.
046795     IF PARM-CHAR (X) NOT = '*'
046796         GO TO FIND-IL-MASK-LOOP.
046797     MOVE 'Y' TO IL-MASK (IL-SUB).
046798     SUBTRACT 1 FROM X.
046799     MOVE X TO IL-LN (IL-SUB).
046800     DISPLAY 'LIBRARY MASK : '
046801             IL-LIB-NO ' TO BE INCLUDED'.
046802     GO TO PROCESS-PARMS.
046803 END-IL-MASK-LOOP.
046804     DISPLAY 'LIBRARY     : '
046805             IL-LIB-NO ' TO BE INCLUDED'.
046806     GO TO PROCESS-PARMS.
046807*************************************************************
046808*  LOAD A EXCLUDE MEMBER RECORD                             *
046809*************************************************************
046810 LOAD-EM.
046811     ADD 1 TO EM-SUB.
046812     IF EM-SUB > 100
046813         DISPLAY 'MORE THAN 100 TYPE EM PARAMETER CARDS'
046814         DISPLAY 'PARAMETER CARD NOT PROCESSED         '
046815         DISPLAY PARM-RECORD
046816         MOVE 999 TO AB-CODE
046817         CALL 'ILBOABN0' USING AB-CODE.
046818     MOVE ZERO TO X.
046819     MOVE PARM-NAME TO EM-MEMB (EM-SUB).
046820 FIND-EM-MASK-LOOP.
046821     ADD 1 TO X.
046822     IF X > 8
046823         GO TO END-EM-MASK-LOOP.
046824     IF PARM-CHAR (X) NOT = '*'
046825         GO TO FIND-EM-MASK-LOOP.
046826     MOVE 'Y' TO EM-MASK (EM-SUB).
046827     SUBTRACT 1 FROM X.
046828     MOVE X TO EM-LN (EM-SUB).
046829     DISPLAY 'MEMBER MASK : ' EM-MEMB (EM-SUB) ' TO BE EXCLUDED'.
046830     GO TO PROCESS-PARMS.
046831 END-EM-MASK-LOOP.
046832     DISPLAY 'MEMBER    : ' EM-MEMB (EM-SUB) ' TO BE EXCLUDED'.
046833     GO TO PROCESS-PARMS.
046834 LOAD-IM.
046835*************************************************************
046836*  LOAD A INCLUDE MEMBER RECORD                             *
046837*************************************************************
046838     ADD 1 TO IM-SUB.
046839     IF IM-SUB > 100
046840         DISPLAY 'MORE THAN 100 TYPE IM PARAMETER CARDS'
046841         DISPLAY 'PARAMETER CARD NOT PROCESSED         '
046842         DISPLAY PARM-RECORD
046843         MOVE 999 TO AB-CODE
046844         CALL 'ILBOABN0' USING AB-CODE.
046845     MOVE ZERO TO X.
046846     MOVE PARM-NAME TO IM-MEMB (IM-SUB).
046847 FIND-IM-MASK-LOOP.
046848     ADD 1 TO X.
046849     IF X > 8
046850         GO TO END-IM-MASK-LOOP.
046851     IF PARM-CHAR (X) NOT = '*'
046852         GO TO FIND-IM-MASK-LOOP.
046853     MOVE 'Y' TO IM-MASK (IM-SUB).
046854     SUBTRACT 1 FROM X.
046855     MOVE X TO IM-LN (IM-SUB).
046856     DISPLAY 'MEMBER MASK : ' IM-MEMB (IM-SUB) ' TO BE INCLUDED'.
046857     GO TO PROCESS-PARMS.
046858 END-IM-MASK-LOOP.
046859     DISPLAY 'MEMBER    : ' IM-MEMB (IM-SUB) ' TO BE INCLUDED'.
046860     GO TO PROCESS-PARMS.
046861 CHECK-PARM-NV.
046862     DISPLAY 'INVALID PARAMETER TYPE'.
046863     DISPLAY 'TYPE MUST BE: E/I L, M'.
046870     DISPLAY 'CARD PROCESSED: ' PARM-RECORD.
046900     MOVE 888 TO AB-CODE.
047000     CALL 'ILBOABN0' USING AB-CODE.
047100 CHK-PARM-COUNT.
047200     MOVE 'N' TO PROCESS-ALL.
047300     IF NBR-RECORDS-READ = ZERO
047400       MOVE 'Y' TO PROCESS-ALL
047500     CLOSE PARMIN.
047600     IF RETURN-CODE > 0
047700       GOBACK.
047710     MOVE 'ICCFMEMB ' TO HEAD-PROGRAM.
047720     MOVE 'MEMBER WITHIN LIBRARY SEQUENCE' TO HEAD-SEQ.
047730     CALL 'G207DCAN' USING G207-FUNC14, HEADER-DATE.
047740     MOVE ' LIBRARY' TO HEAD-R-4-A.
047750     MOVE '  NUMB' TO HEAD-R-5-A.
047751     MOVE ' MEMBER ' TO HEAD-R-4-B.
047752     MOVE '  NAME' TO HEAD-R-5-B.
047760     MOVE 'ICCF BACKUP -- MEMBER LIST'
047770         TO HEAD-SYS-DESC.
047771     MOVE SPACE TO DETAIL-LINE.
047780     MOVE 0 TO PAGE-CNT.
047800*************************************************************
047900*  PROCESS ICCF BACKUP RECORDS                              *
048000*************************************************************
048100     MOVE  0  TO NBR-RECORDS-READ.
048200     OPEN INPUT  ICCF-INP.
048210     OPEN OUTPUT LIST-OUT.
048220     OPEN OUTPUT MEMBER-OUT.
049600     PERFORM PRINT-HEADINGS-ROUTINE THROUGH PRINT-EXIT.
049800*************************************************************
049900 READ-BKP.
050000*************************************************************
050100*  READ AN ICCF BACKUP RECORD.                              *
050200*************************************************************
050300     READ ICCF-INP AT END
050400         GO TO END-OF-PROGRAM.
051500     ADD 1 TO NBR-RECORDS-READ.
051600*************************************************************
051700*  CHECK PROCESS-ALL                                        *
051800*************************************************************
051920     IF PROCESS-ALL = 'Y'
052000       GO TO FORMAT-DATA.
052010     MOVE ZERO TO EL-SUB2.
052020     MOVE ZERO TO IL-SUB2.
052030     MOVE ZERO TO EM-SUB2.
052040     MOVE ZERO TO IM-SUB2.
052100     IF BKP-HEADER = 'L$'
052200         AND BKP-REC-TYPE = HIGH-VALUES
052210         MOVE '0' TO LIB-WANTED
052300         GO TO CHK-EL.
052400     IF BKP-HEADER = 'H$'
052500         AND BKP-REC-TYPE = HIGH-VALUES
052501         AND LIB-WANTED = '1'
052510         MOVE '0' TO MEM-WANTED
052600         GO TO CHK-EM.
052700     IF LIB-WANTED = '1'
052800         AND MEM-WANTED = '1'
052900         GO TO FORMAT-DATA.
053000     GO TO READ-BKP.
055813*************************************************************
055814*  CHECK TO SEE LIBRARY NUMBER IS TO BE EXCLUDED            *
055815*************************************************************
055816 CHK-EL.
055817     IF EL-SUB = ZERO
055818       GO TO CHK-IL.
055819     ADD 1 TO EL-SUB2.
055820     IF EL-SUB2 > EL-SUB
055821       GO TO CHK-IL.
055822     MOVE 'N' TO CONT.
055823     IF BKP-LIB-NO = EL-LIB (EL-SUB2)
055828         MOVE 'Y' TO CONT.
055829     IF CONT = 'Y'
055830       GO TO READ-BKP.
055831     GO TO CHK-EL.
055832*************************************************************
055833*  CHECK TO SEE LIBRARY NUMBER IS TO BE INCLUDED            *
055834*************************************************************
055835 CHK-IL.
055836     IF IL-SUB = ZERO
055837       GO TO LIB-FOUND.
055838     ADD 1 TO IL-SUB2.
055839     IF IL-SUB2 > IL-SUB
055840       GO TO READ-BKP.
055841     MOVE 'N' TO CONT.
055843     IF BKP-LIB-NO = IL-LIB (IL-SUB2)
055844         MOVE 'Y' TO CONT.
055849     IF CONT = 'Y'
055850       GO TO LIB-FOUND.
055851     GO TO CHK-IL.
055852*************************************************************
055853*  CHECK TO SEE MEMBER IS TO BE EXCLUDED                    *
055854*************************************************************
055855 CHK-EM.
055856     IF EM-SUB = ZERO
055857       GO TO CHK-IM.
055858     ADD 1 TO EM-SUB2.
055859     IF EM-SUB2 > EM-SUB
055860       GO TO CHK-IM.
055861     MOVE 'N' TO CONT.
055862     MOVE SPACES TO WORK-VALUE.
055863     MOVE BKP-MEM-NAME TO WORK-VALUE.
055864     MOVE EM-MEMB (EM-SUB2) TO CHK-FLD.
055865     MOVE EM-LN (EM-SUB2) TO CHK-LN.
055866     MOVE EM-MASK (EM-SUB2) TO CHK-MASK.
055867     PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
055868     IF CONT = 'Y'
055869       GO TO READ-BKP.
055870     GO TO CHK-EM.
055871 LIB-FOUND.
055872     MOVE '1' TO LIB-WANTED.
055874     MOVE BKP-LIB-NO TO D-LIBRY-ID.
055875     GO TO READ-BKP.
055876*************************************************************
055877*  CHECK TO SEE MEMBER IS TO BE INCLUDED                    *
055878*************************************************************
055879 CHK-IM.
055880     IF IM-SUB = ZERO
055881       GO TO MEM-FOUND.
055882     ADD 1 TO IM-SUB2.
055883     IF IM-SUB2 > IM-SUB
055884       GO TO READ-BKP.
055885     MOVE 'N' TO CONT.
055886     MOVE SPACES TO WORK-VALUE.
055887     MOVE BKP-MEM-NAME TO WORK-VALUE.
055888     MOVE IM-MEMB (IM-SUB2) TO CHK-FLD.
055889     MOVE IM-LN (IM-SUB2) TO CHK-LN.
055890     MOVE IM-MASK (IM-SUB2) TO CHK-MASK.
055891     PERFORM CHECK-FIELD THRU CHK-FLD-EXIT.
055892     IF CONT = 'Y'
055893       GO TO MEM-FOUND.
055894     GO TO CHK-IM.
055895 MEM-FOUND.
055896     MOVE '1' TO MEM-WANTED.
055897     MOVE BKP-MEM-NAME TO D-ENTRY-ID.
055898     MOVE BKP-MEM-NAME TO CTL-NAME.
055899     MOVE SPACE TO CARD-OUT.
055900     MOVE CTL-CARD TO CARD-OUT.
055901     WRITE CARD-OUT.
055902     GO TO WRITE-REPORT.
055903 FORMAT-DATA.
055904*************************************************************
055910*  GET DATA FROM RECORD                                     *
056000*************************************************************
057410     ADD 1 TO NBR-RECORDS-USED.
057420     MOVE ICCF-BKP-IN TO CARD-OUT.
057430     WRITE CARD-OUT.
057440     GO TO READ-BKP.
060200 WRITE-REPORT.
071600     MOVE DETAIL-LINE TO PRINT-LINE.
071700     PERFORM PRINT-1 THROUGH PRINT-EXIT.
071800     GO TO READ-BKP.
072000 PRINT-HEADINGS-ROUTINE.
072100     ADD 1 TO PAGE-CNT.
072200     MOVE PAGE-CNT TO HEAD-PAGE.
072300     MOVE HEAD-1 TO PRINT-LINE.
072400     WRITE PRINT-LINE AFTER ADVANCING TO-CHAN-1.
072500     MOVE HEAD-2 TO PRINT-LINE.
072600     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
072700     MOVE HEAD-3 TO PRINT-LINE.
072800     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
072900     MOVE HEAD-4 TO PRINT-LINE.
073000     WRITE PRINT-LINE AFTER ADVANCING 2 LINES.
073100     MOVE HEAD-5 TO PRINT-LINE.
073200     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
073300     MOVE SPACE TO PRINT-LINE.
073400     MOVE 6 TO LINE-COUNT.
073500 PRINT-1.
073600     WRITE PRINT-LINE AFTER ADVANCING 1 LINES.
073700     ADD 1 TO LINE-COUNT.
073800     IF LINE-COUNT > 56
073900         PERFORM PRINT-HEADINGS-ROUTINE.
074000 PRINT-EXIT.
074100     EXIT.
074200*************************************************************
074300 CHECK-FIELD.
074400*************************************************************
074500*  CHK FOR EXCLUDE OR INCLUDE                               *
074600*************************************************************
074700     MOVE 'Y' TO CONT.
074800     IF CHK-MASK NOT = 'Y'
074900         AND CHK-FLD NOT = WORK-VALUE
075000         MOVE 'N' TO CONT
075100         GO TO CHK-FLD-EXIT.
075200     MOVE ZERO TO X.
075300 CHK-CHAR-LOOP.
075400     ADD 1 TO X.
075500     IF X > CHK-LN
075600         GO TO CHK-FLD-EXIT.
075700     IF X > 8
075800         GO TO CHK-FLD-EXIT.
075900     IF WK-CHAR (X) NOT = CHK-CHAR (X)
076000         MOVE 'N' TO CONT
076100         GO TO CHK-FLD-EXIT.
076200     GO TO CHK-CHAR-LOOP.
076300 CHK-FLD-EXIT.
076400     EXIT.
079100 END-OF-PROGRAM.
079200     CLOSE ICCF-INP.
079210     CLOSE LIST-OUT.
079220     CLOSE MEMBER-OUT.
079300     DISPLAY 'NUMBER RECORDS READ = ' NBR-RECORDS-READ.
079400     DISPLAY 'NUMBER RECORDS USED = ' NBR-RECORDS-USED.
079500     MOVE ZERO TO RETURN-CODE.
079600     GOBACK.
