000100 ID DIVISION.
000200 PROGRAM-ID. CICSSMF.
000300 AUTHOR. MATTHEW STITT.
000400 DATE-WRITTEN. 06/28/91.
000500 DATE-COMPILED.
000600 REMARKS.  UNLOAD CICS STATISTICS RECORDS FROM SMF DUMP.
000610*****************************************************************
000620*  THIS PROGRAM MUST BE COMPILED WITH THE CICS COBOL COPY BOOK  *
000630*  LIBRARY ADDED TO THE SOURCE LIBRARY SEARCH CHAIN.            *
000640*                                                               *
000650*  THIS PROGRAM IS WRITTEN TO COBOL/370 PROGRAMMING LEVEL       *
000660*****************************************************************
000700 ENVIRONMENT DIVISION.
000800 CONFIGURATION SECTION.
000900 SOURCE-COMPUTER.  IBM-3081.
001000 OBJECT-COMPUTER.  IBM-3081.
001100 SPECIAL-NAMES.
001200     C01 IS TO-CHAN-1.
001300 INPUT-OUTPUT SECTION.
001400 FILE-CONTROL.
001500     SELECT SMFIN    ASSIGN TO UT-S-SYS004.
001610     SELECT STATS-OUT ASSIGN TO UT-S-SYS021.
001700 DATA DIVISION.
001800 FILE SECTION.
001900 FD  SMFIN
002000     LABEL RECORDS ARE STANDARD
002010*    RECORD CONTAINS 156 TO 32760 CHARACTERS
002020*    BLOCK CONTAINS 0 RECORDS
002030*    RECORDING MODE IS V.
002100     RECORD CONTAINS 0 CHARACTERS
002200     BLOCK CONTAINS 32756 CHARACTERS
002300     RECORDING MODE IS S.
002500*01  SMF-RECORD-1            PIC X(156).
002600 01  SMF-RECORD              PIC X(32760).
002910 FD  STATS-OUT
002920     LABEL RECORDS ARE STANDARD
002930     BLOCK CONTAINS 1 TO 9 RECORDS
002940     RECORD CONTAINS 157 TO 3496 CHARACTERS
002950     RECORDING MODE IS V.
002951 01  STATS-RECORD.
002952     02  STATS-HEADER        PIC X(154).
002953     02  STATS-INFO.
002954         03  STATS-DATA-LEN  PIC S9(4)  COMP.
002955         03  STATS-DATA      OCCURS 1 TO 3340 TIMES DEPENDING ON
002956                             STATS-DATA-LEN.
002957             04  DATA-CHAR   PIC X.
003030 WORKING-STORAGE SECTION.
003040 77  WS-START                PIC X(36) VALUE
003050     'CICSSMF WORKING STORAGE STARTS HERE'.
003100 77  NBR-RECORDS-READ        PIC 9(18) VALUE ZERO.
003200 77  NBR-RECORDS-USED        PIC 9(18) VALUE ZERO.
003500 77  SECTION-COUNT           PIC 9(4)  COMP.
004110 77  SET-ZERO                PIC 9(02) VALUE ZERO.
004600 77  AB-CODE                 PIC S9(3)  COMP    VALUE ZERO.
004700 01  DFH-LENGTH              PIC 9(4)  COMP.
004800 01  DFH-LEN             REDEFINES DFH-LENGTH.
004900     02  DFH-LEN-1           PIC X.
005000     02  DFH-LEN-2           PIC X.
015400 COPY DFHSTIDS.
015410 COPY DFHSMFDS.
015500 COPY DFHA03DS.
015600 COPY DFHA04DS.
015700*COPY DFHA05DS.
015800 COPY DFHA06DS.
015900 COPY DFHA08DS.
016000 COPY DFHA09DS.
016100*COPY DFHA10DS.
016200*COPY DFHA11DS.
016300*COPY DFHA12DS.
016400*COPY DFHA13DS.
016500 COPY DFHA14DS.
016600 COPY DFHA16DS.
016700 COPY DFHA17DS.
016800*COPY DFHA18DS.
016900*COPY DFHA19DS.
017000 COPY DFHA20DS.
017100 COPY DFHA21DS.
017200 COPY DFHA22DS.
017300 COPY DFHA23DS.
017400 COPY DFHA24DS.
017500*COPY DFHA25DS.
017600*COPY DFHAUSDS.
017610 COPY DFHCFS6D.
017620 COPY DFHCFS7D.
017630 COPY DFHCFS8D.
017640 COPY DFHCFS9D.
017700 COPY DFHDBUDS.
017800 COPY DFHDSGDS.
017810 COPY DFHD2GDS.
017820 COPY DFHD2RDS.
017900 COPY DFHLDGDS.
018000 COPY DFHLDRDS.
018010 COPY DFHLGRDS.
018020 COPY DFHLGSDS.
018100 COPY DFHMNGDS.
018200 COPY DFHMNTDS.
018210 COPY DFHNCS4D.
018220 COPY DFHNCS5D.
018230 COPY DFHNQGDS.
018300 COPY DFHPGGDS.
018310 COPY DFHRMGDS.
018400 COPY DFHSDGDS.
018500 COPY DFHSDRDS.
018600 COPY DFHSMDDS.
018700 COPY DFHSMSDS.
018800 COPY DFHSMTDS.
018810 COPY DFHSORDS.
018900 COPY DFHSTGDS.
019000 COPY DFHTDGDS.
019100 COPY DFHTDRDS.
019110 COPY DFHTQRDS.
019120 COPY DFHTQGDS.
019130 COPY DFHTSGDS.
019200 COPY DFHUSGDS.
019300 COPY DFHXMCDS.
019400 COPY DFHXMGDS.
019500 COPY DFHXMRDS.
019510 COPY DFHXQS1D.
019520 COPY DFHXQS2D.
019530 COPY DFHXQS3D.
019600 01  WORK-ARRAY-1.
019700     02  ARRAY-ONE           OCCURS 32760 TIMES  INDEXED BY A1.
019800         03  CHAR-ONE            PIC X.
019900 01  WORK-ARRAY-2.
020000     02  ARRAY-TWO           OCCURS 32760 TIMES  INDEXED BY A2.
020100         03  CHAR-TWO            PIC X.
020110 01  WORK-ARRAY-3.
020120     02  ARRAY-THREE         OCCURS 32760 TIMES  INDEXED BY A3.
020130         03  CHAR-THREE          PIC X.
020200 PROCEDURE DIVISION.
020300     MOVE  0  TO NBR-RECORDS-READ.
020900     OPEN INPUT  SMFIN.
021000     OPEN OUTPUT STATS-OUT.
023300*************************************************************
023400 READ-SMF.
023500*************************************************************
023600*  READ AN SMF RECORD                                       *
023700*************************************************************
023800     READ SMFIN AT END
023900         GO TO 999-EXIT.
024000     ADD 1 TO NBR-RECORDS-READ.
024001     MOVE LOW-VALUES TO WORK-ARRAY-1.
024010     MOVE SMF-RECORD TO WORK-ARRAY-1, DFHSMFDS.
024100*************************************************************
024200*  IS IT A TYPE 110 X'6E'                                   *
024300*************************************************************
024400     IF NOT SMF110
024500         GO TO READ-SMF.
024510     IF NOT SMFSTSTY
024520         GO TO READ-SMF.
024600 FORMAT-DATA.
024700*************************************************************
024800*  GET DATA FROM RECORD                                     *
024900*************************************************************
026600     ADD 1 TO NBR-RECORDS-USED.
026610 DECODE-DATA.
026630     MOVE LOW-VALUES TO WORK-ARRAY-2.
026640     SET A1 TO SMFASS.
026650     SET A1 DOWN BY 4.
026670     MOVE SMFASN TO SECTION-COUNT.
026671 REPEAT-SECTION.
026681     IF SECTION-COUNT = ZERO
026682         GO TO READ-SMF.
026683     SUBTRACT 1 FROM SECTION-COUNT.
026690     SET A2 TO SET-ZERO.
026691     MOVE DFHSMFDS TO STATS-HEADER.
026692 MOVE-SECTION.
026694     SET A2 UP BY 1.
026695     IF A2 > SMFASL
026696         GO TO END-MOVE-SECTION.
026697     SET A1 UP BY 1.
026698     MOVE CHAR-ONE (A1) TO CHAR-TWO (A2).
026699     GO TO MOVE-SECTION.
026700 END-MOVE-SECTION.
026702     SET A2 TO SET-ZERO.
026704 REPEAT-DATA.
026705     IF A2 > SMFASL
026706         OR A2 = SMFASL
026707         GO TO REPEAT-SECTION.
026708     SET A2 UP BY 1.
026709     MOVE CHAR-TWO (A2) TO DFH-LEN-1.
026710     SET A2 UP BY 1.
026711     MOVE CHAR-TWO (A2) TO DFH-LEN-2.
026712     SET A2 DOWN BY 2.
026713     SET A3 TO SET-ZERO.
026714     MOVE LOW-VALUES TO WORK-ARRAY-3.
026715 MOVE-DATA.
026718     SET A3 UP BY 1.
026719     IF A3 > DFH-LENGTH
026720         GO TO END-MOVE-DATA.
026721     SET A2 UP BY 1.
026722     IF A2 > SMFASL
026723         GO TO END-MOVE-DATA.
026724     MOVE CHAR-TWO (A2) TO CHAR-THREE (A3).
026725     GO TO MOVE-DATA.
026726 END-MOVE-DATA.
026727     MOVE DFHSMFDS TO STATS-HEADER.
026728     MOVE WORK-ARRAY-3 TO DFHSTIDS.
026729     IF STISMDSA                                                        00
026730         GO TO MOVE-DFHSMSDS.
026758     IF STISMD                                                          00
026759         GO TO MOVE-DFHSMDDS.
026799     IF STISMT                                                          00
026800         GO TO MOVE-DFHSMTDS.
026839     IF STIXMG                                                          00
026840         GO TO MOVE-DFHXMGDS.
026878     IF STIXMR                                                          00
026879         GO TO MOVE-DFHXMRDS.
026916     IF STIXMC                                                          00
026917         GO TO MOVE-DFHXMCDS.
026953     IF STIFEPIP                                                        00
026954         GO TO MOVE-DFHA22DS.
026989     IF STIFEPIC                                                        00
026990         GO TO MOVE-DFHA23DS.
027024     IF STIFEPIT                                                        00
027025         GO TO MOVE-DFHA24DS.
027058     IF STIVT                                                           00
027059         GO TO MOVE-DFHA03DS.
027123     IF STIPAUTO                                                        00
027124         GO TO MOVE-DFHPGGDS.
027154     IF STIAUTO                                                         00
027155         GO TO MOVE-DFHA04DS.
027184     IF STILDR                                                          00
027185         GO TO MOVE-DFHLDRDS.
027213     IF STIDBUSS                                                        00
027214         GO TO MOVE-DFHDBUDS.
027241     IF STILDG                                                          00
027242         GO TO MOVE-DFHLDGDS.
027294     IF STITCR                                                          00
027295         GO TO MOVE-DFHA06DS.
027319     IF STILSRR                                                         00
027320         GO TO MOVE-DFHA08DS.
027343     IF STILSRFR                                                        00
027344         GO TO MOVE-DFHA09DS.
027366     IF STITDQR                                                         00
027367         GO TO MOVE-DFHTQRDS.
027388     IF STITDQG                                                         00
027389         GO TO MOVE-DFHTQGDS.
027409     IF STITSQ                                                          00
027410         GO TO MOVE-DFHTSGDS.
027448     IF STICONSR                                                        00
027449         GO TO MOVE-DFHA14DS.
027466     IF STICONSS                                                        00
027467         GO TO MOVE-DFHA21DS.
027483     IF STIDS                                                           00
027484         GO TO MOVE-DFHDSGDS.
027499     IF STIUSG                                                          00
027500         GO TO MOVE-DFHUSGDS.
027514     IF STITM                                                           00
027515         GO TO MOVE-DFHA16DS.
027528     IF STIST                                                           00
027529         GO TO MOVE-DFHSTGDS.
027541     IF STIFCR                                                          00
027542         GO TO MOVE-DFHA17DS.
027583     IF STICONMR                                                        00
027584         GO TO MOVE-DFHA20DS.
027591     IF STIMNR                                                          00
027592         GO TO MOVE-DFHMNTDS.
027598     IF STIM
027599         GO TO MOVE-DFHMNGDS.
027604     IF STITDR                                                          00
027605         GO TO MOVE-DFHTDRDS.
027609     IF STITDG                                                          00
027610         GO TO MOVE-DFHTDGDS.
027613     IF STISDR                                                          00
027614         GO TO MOVE-DFHSDRDS.
027615     IF STISDG                                                          00
027616         GO TO MOVE-DFHSDGDS.
027617     IF STILGR                                                          00
027618         GO TO MOVE-DFHLGRDS.
027619     IF STILGS                                                          00
027620         GO TO MOVE-DFHLGSDS.
027621     IF STINQG                                                          00
027622         GO TO MOVE-DFHNQGDS.
027623     IF STIRMG                                                          00
027624         GO TO MOVE-DFHRMGDS.
027625     IF STID2G                                                          00
027626         GO TO MOVE-DFHD2GDS.
027627     IF STID2GR                                                         00
027628         GO TO MOVE-DFHD2RDS.
027629     IF STISOR                                                          00
027630         GO TO MOVE-DFHSORDS.
027631     DISPLAY 'INVALID CICS STATISTICS RECORD TYPE ' DFHSTIDS.
027632     GO TO REPEAT-DATA.
027633 MOVE-DFHA03DS.
027634     MOVE WORK-ARRAY-3 TO DFHA03DS.
027635     MOVE DFHA03DS TO STATS-INFO.
027636     GO TO WRITE-DATA.
027637 MOVE-DFHA04DS.
027638     MOVE WORK-ARRAY-3 TO DFHA04DS.
027639     MOVE DFHA04DS TO STATS-INFO.
027640     GO TO WRITE-DATA.
027645 MOVE-DFHA06DS.
027646     MOVE WORK-ARRAY-3 TO DFHA06DS.
027647     MOVE DFHA06DS TO STATS-INFO.
027648     GO TO WRITE-DATA.
027649 MOVE-DFHA08DS.
027650     MOVE WORK-ARRAY-3 TO DFHA08DS.
027651     MOVE DFHA08DS TO STATS-INFO.
027652     GO TO WRITE-DATA.
027653 MOVE-DFHA09DS.
027654     MOVE WORK-ARRAY-3 TO DFHA09DS.
027655     MOVE DFHA09DS TO STATS-INFO.
027656     GO TO WRITE-DATA.
027657 MOVE-DFHTQRDS.
027658     MOVE WORK-ARRAY-3 TO DFHTQRDS.
027659     MOVE DFHTQRDS TO STATS-INFO.
027660     GO TO WRITE-DATA.
027661 MOVE-DFHTQGDS.
027662     MOVE WORK-ARRAY-3 TO DFHTQGDS.
027663     MOVE DFHTQGDS TO STATS-INFO.
027664     GO TO WRITE-DATA.
027665 MOVE-DFHTSGDS.
027666     MOVE WORK-ARRAY-3 TO DFHTSGDS.
027667     MOVE DFHTSGDS TO STATS-INFO.
027668     GO TO WRITE-DATA.
027673 MOVE-DFHA14DS.
027674     MOVE WORK-ARRAY-3 TO DFHA14DS.
027675     MOVE DFHA14DS TO STATS-INFO.
027676     GO TO WRITE-DATA.
027677 MOVE-DFHA16DS.
027678     MOVE WORK-ARRAY-3 TO DFHA16DS.
027679     MOVE DFHA16DS TO STATS-INFO.
027680     GO TO WRITE-DATA.
027681 MOVE-DFHA17DS.
027682     MOVE WORK-ARRAY-3 TO DFHA17DS.
027683     MOVE DFHA17DS TO STATS-INFO.
027684     GO TO WRITE-DATA.
027693 MOVE-DFHA20DS.
027694     MOVE WORK-ARRAY-3 TO DFHA20DS.
027695     MOVE DFHA20DS TO STATS-INFO.
027697     GO TO WRITE-DATA.
027698 MOVE-DFHA21DS.
027699     MOVE WORK-ARRAY-3 TO DFHA21DS.
027700     MOVE DFHA21DS TO STATS-INFO.
027702     GO TO WRITE-DATA.
027703 MOVE-DFHA22DS.
027704     MOVE WORK-ARRAY-3 TO DFHA22DS.
027705     MOVE DFHA22DS TO STATS-INFO.
027707     GO TO WRITE-DATA.
027708 MOVE-DFHA23DS.
027709     MOVE WORK-ARRAY-3 TO DFHA23DS.
027710     MOVE DFHA23DS TO STATS-INFO.
027712     GO TO WRITE-DATA.
027713 MOVE-DFHA24DS.
027714     MOVE WORK-ARRAY-3 TO DFHA24DS.
027715     MOVE DFHA24DS TO STATS-INFO.
027717     GO TO WRITE-DATA.
027728 MOVE-DFHDBUDS.
027729     MOVE WORK-ARRAY-3 TO DFHDBUDS.
027730     MOVE DFHDBUDS TO STATS-INFO.
027732     GO TO WRITE-DATA.
027733 MOVE-DFHDSGDS.
027734     MOVE WORK-ARRAY-3 TO DFHDSGDS.
027735     MOVE DFHDSGDS TO STATS-INFO.
027737     GO TO WRITE-DATA.
027738 MOVE-DFHLDGDS.
027739     MOVE WORK-ARRAY-3 TO DFHLDGDS.
027740     MOVE DFHLDGDS TO STATS-INFO.
027742     GO TO WRITE-DATA.
027743 MOVE-DFHLDRDS.
027744     MOVE WORK-ARRAY-3 TO DFHLDRDS.
027745     MOVE DFHLDRDS TO STATS-INFO.
027747     GO TO WRITE-DATA.
027748 MOVE-DFHMNGDS.
027749     MOVE WORK-ARRAY-3 TO DFHMNGDS.
027750     MOVE DFHMNGDS TO STATS-INFO.
027752     GO TO WRITE-DATA.
027753 MOVE-DFHMNTDS.
027754     MOVE WORK-ARRAY-3 TO DFHMNTDS.
027755     MOVE DFHMNTDS TO STATS-INFO.
027757     GO TO WRITE-DATA.
027758 MOVE-DFHPGGDS.
027759     MOVE WORK-ARRAY-3 TO DFHPGGDS.
027760     MOVE DFHPGGDS TO STATS-INFO.
027762     GO TO WRITE-DATA.
027763 MOVE-DFHSDGDS.
027764     MOVE WORK-ARRAY-3 TO DFHSDGDS.
027765     MOVE DFHSDGDS TO STATS-INFO.
027767     GO TO WRITE-DATA.
027768 MOVE-DFHSDRDS.
027769     MOVE WORK-ARRAY-3 TO DFHSDRDS.
027770     MOVE DFHSDRDS TO STATS-INFO.
027772     GO TO WRITE-DATA.
027773 MOVE-DFHSMDDS.
027774     MOVE WORK-ARRAY-3 TO DFHSMDDS.
027775     MOVE DFHSMDDS TO STATS-INFO.
027777     GO TO WRITE-DATA.
027778 MOVE-DFHSMSDS.
027779     MOVE WORK-ARRAY-3 TO DFHSMSDS.
027780     MOVE DFHSMSDS TO STATS-INFO.
027782     GO TO WRITE-DATA.
027783 MOVE-DFHSMTDS.
027784     MOVE WORK-ARRAY-3 TO DFHSMTDS.
027785     MOVE DFHSMTDS TO STATS-INFO.
027786     GO TO WRITE-DATA.
027787 MOVE-DFHSTGDS.
027788     MOVE WORK-ARRAY-3 TO DFHSTGDS.
027789     MOVE DFHSTGDS TO STATS-INFO.
027790     GO TO WRITE-DATA.
027791 MOVE-DFHTDGDS.
027792     MOVE WORK-ARRAY-3 TO DFHTDGDS.
027793     MOVE DFHTDGDS TO STATS-INFO.
027794     GO TO WRITE-DATA.
027795 MOVE-DFHTDRDS.
027796     MOVE WORK-ARRAY-3 TO DFHTDRDS.
027797     MOVE DFHTDRDS TO STATS-INFO.
027798     GO TO WRITE-DATA.
027799 MOVE-DFHUSGDS.
027800     MOVE WORK-ARRAY-3 TO DFHUSGDS.
027801     MOVE DFHUSGDS TO STATS-INFO.
027802     GO TO WRITE-DATA.
027803 MOVE-DFHXMCDS.
027804     MOVE WORK-ARRAY-3 TO DFHXMCDS.
027805     MOVE DFHXMCDS TO STATS-INFO.
027806     GO TO WRITE-DATA.
027807 MOVE-DFHXMGDS.
027808     MOVE WORK-ARRAY-3 TO DFHXMGDS.
027809     MOVE DFHXMGDS TO STATS-INFO.
027810     GO TO WRITE-DATA.
027811 MOVE-DFHXMRDS.
027812     MOVE WORK-ARRAY-3 TO DFHXMRDS.
027820     MOVE DFHXMRDS TO STATS-INFO.
027900     GO TO WRITE-DATA.
027902 MOVE-DFHLGRDS.
027903     MOVE WORK-ARRAY-3 TO DFHLGRDS.
027904     MOVE DFHLGRDS TO STATS-INFO.
027905     GO TO WRITE-DATA.
027906 MOVE-DFHLGSDS.
027907     MOVE WORK-ARRAY-3 TO DFHLGSDS.
027908     MOVE DFHLGSDS TO STATS-INFO.
027909     GO TO WRITE-DATA.
027910 MOVE-DFHNQGDS.
027911     MOVE WORK-ARRAY-3 TO DFHNQGDS.
027912     MOVE DFHNQGDS TO STATS-INFO.
027913     GO TO WRITE-DATA.
027914 MOVE-DFHRMGDS.
027915     MOVE WORK-ARRAY-3 TO DFHRMGDS.
027916     MOVE DFHRMGDS TO STATS-INFO.
027917     GO TO WRITE-DATA.
027918 MOVE-DFHD2GDS.
027919     MOVE WORK-ARRAY-3 TO DFHD2GDS.
027920     MOVE DFHD2GDS TO STATS-INFO.
027921     GO TO WRITE-DATA.
027922 MOVE-DFHD2RDS.
027923     MOVE WORK-ARRAY-3 TO DFHD2RDS.
027924     MOVE DFHD2RDS TO STATS-INFO.
027925     GO TO WRITE-DATA.
027926 MOVE-DFHSORDS.
027927     MOVE WORK-ARRAY-3 TO DFHSORDS.
027928     MOVE DFHSORDS TO STATS-INFO.
027929     GO TO WRITE-DATA.
027930 WRITE-DATA.
028000     WRITE STATS-RECORD.
028100     GO TO REPEAT-DATA.
032000 999-EXIT.
032100     CLOSE SMFIN STATS-OUT.
032200     DISPLAY 'NUMBER RECORDS READ = ' NBR-RECORDS-READ.
032300     DISPLAY 'NUMBER RECORDS USED = ' NBR-RECORDS-USED.
032400     MOVE ZERO TO RETURN-CODE.
032500     GOBACK.
